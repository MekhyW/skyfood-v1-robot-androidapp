import{y as e,ai as t,r as s,R as o,$ as a,P as l,as as i,Q as n,aR as d,Z as r,d as c,ay as f,a6 as p,aS as m,L as g,az as w,_ as u}from"./index-d6250428.js";import{C as b,r as v,W as x,p as y,aZ as h,a1 as j,c as I,u as q,a as A,T as k,M as C,R,K as B,z,a4 as _,b3 as T,b2 as S,o as E,w as F}from"./@vue-73fba911.js";import{E as U}from"./emergeStop-7b0c76e4.js";import{T as M}from"./WifSwitch-9a99189c.js";import{u as D}from"./vue-i18n-5829ac11.js";import"./vue-router-fe18c2fe.js";import"./pinia-118dd6fd.js";import"./element-plus-5a8aeb67.js";import"./dayjs-4c03de08.js";import"./@autoxing-9bbbdd2d.js";import"./axios-2c1be958.js";import"./websocket-963e06e0.js";import"./es5-ext-689fde2c.js";import"./lodash-es-fa68f30b.js";import"./@vueuse-171ed302.js";import"./@element-plus-c72353dc.js";import"./@ctrl-ee9bdfd4.js";import"./async-validator-efc2d198.js";import"./@popperjs-892fd7f5.js";import"./escape-html-4bbaf1e1.js";import"./normalize-wheel-es-da779ce4.js";import"./vue3-loading-overlay-a6191c09.js";import"./vue-slider-component-7621b196.js";import"./vue-6ec50eb9.js";import"./mitt-dab1f1cb.js";import"./swiper-276df855.js";import"./ssr-window-792d0f84.js";import"./dom7-250848e3.js";import"./amfe-flexible-1f7bb7f4.js";import"./@intlify-352b7567.js";const Q=e=>(T("data-v-e180777e"),e=e(),S(),e),Y={class:"follow-box"},P={key:0,class:"uwb-info"},Z={class:"run-mode"},K=_(),G={class:"follow-info"},H={key:0,class:"follow-left"},L={class:"text"},N={class:"text-info"},O={key:1,class:"follow-left"},W={class:"text"},J={class:"text-info step-1"},V={key:2,class:"follow-left"},X={class:"text"},$={class:"text-info step-2"},ee={key:3,class:"follow-left"},te={class:"text"},se={class:"text-info step-4"},oe={key:4,class:"follow-left"},ae={class:"text"},le={class:"text-info step-4"},ie={class:"follow-right"},ne=Q((()=>A("img",{src:"data:image/png;base64,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",alt:""},null,-1))),de={class:"btn-list"},re={key:1,class:"btn step-1"},ce={key:2},fe={class:"btn step-2"},pe={class:"btn step-2"},me={key:3,class:"btn step-3"},ge={key:4,class:"btn step-2"},we={key:5,class:"btn step-1"},ue={key:1,class:"ocenter abnormaltank"},be={class:"erroinner bind-info"},ve=Q((()=>A("h3",{class:"min-title"},[_("没有检测到编号为1110的跟随手环，请检查手环电量并长按开机键进行开机"),A("br"),_("当前机器人正在使用激光雷达进行跟随定位")],-1))),xe={class:"base_tip_meth font7"},ye={key:2,class:"emerge-stop-box"},he={key:3,class:"ocenter abnormaltank"},je={key:0,class:"erroinner bind-info"},Ie={class:"err-title"},qe=_(),Ae=[Q((()=>A("img",{src:d,alt:""},null,-1)))],ke={class:"error-info"},Ce={class:"tit-info"},Re={class:"btnLists"},Be={key:1,class:"erroinner bind-info"},ze={class:"tip2starup"},_e=Q((()=>A("div",{class:"ico_sty"},[A("img",{src:r,style:{width:"100%",height:"100%"}})],-1))),Te=["innerHTML"],Se={class:"tip3starup"},Ee={class:"btnLists"},Fe=b({beforeRouteLeave(e,t,a){let l=s();const i=2==l.follow_target_mode?3:l.follow_target_mode;setTimeout((()=>{o.getInstance().sendLaserData({topic:"/laser_state",cmd:"follow.sleep",followType:i})}),1e3),a()}}),Ue=u(b({...Fe,__name:"Follow",setup(d){const r=e();t();const{t:u}=D();let b=v(0),_=v(0),T=v(!1),S=x({follow_target_mode:0,runType:!0,device:0,deviceId:"",band:0,errCode:0});const Q=y((()=>[1].includes(S.device)?u("index.cg"):u("index.wlj"))),Fe=y((()=>[1].includes(S.band)?u("index.zc"):u("index.wxh")));let Ue=!1;const Me=[];function De(){r.robotstate.battery<=r.customSetting.otherSetting.lowBattery&&!Ue&&(Ue=!0,i.show({data:{errText:n.global.t("starup.ts"),errInfo:n.global.t("starup.dqdldbcrwjshjqrzdfhcdzcd"),errType:129},sureText:n.global.t("index.qd")}))}const Qe=w((function(e,t){g.logErrNew("RealState",e,t)}),1e3);h((()=>{let e=s();S.follow_target_mode=2==e.follow_target_mode?3:e.follow_target_mode,c.currentRoute.value.fullPath.includes("Follow")&&(!function(){Ue=!1;let e=F((()=>r.robotstate.battery),((e,t)=>{e&&De()})),t=F((()=>b.value),((e,t)=>{3==e&&De()}),{immediate:!0});Me.push(e),Me.push(t)}(),o.getInstance().sendLaserData({topic:"/laser_state",cmd:"follow.wakeup",followType:S.follow_target_mode}));const t=a.offlineSetting.followSetting||{};S.runType=2==t.runMode,b.value=0,f.on("follow",(e=>{if((new Date).getTime(),"initialized"===e.follow_state)b.value=1;else if("initializing"===e.follow_state)b.value=1;else if("initialize_failed"===e.follow_state)Qe("initialize_failed",{errCode:100015,errText:"initialize_failed",...a.getUploadLog()}),b.value=5;else if("tracking"===e.follow_state)b.value=3;else if("lost"===e.follow_state)b.value=4,Qe("follow_lost",{errCode:100015,errText:"follow_lost",...a.getUploadLog()});else if("unreachable"===e.follow_state){if(e.messageInfo&&e.messageInfo.errCode&&!Ze.show){Ze.show=!0,Ze.type=2,Ze.errCode=e.messageInfo.errCode,Ze.errMessage=e.messageInfo.errMessage;let t=p();(m[t]&&m[t][Ze.errCode]||m.en[Ze.errCode])&&(Ze.errMessage=m[t]&&m[t][Ze.errCode]||m.en[Ze.errCode])}Qe("unreachable",{data:e.messageInfo,...a.getUploadLog()})}else"stop"===e.follow_state?(b.value=0,g.logErrNew("RealState","stop",{data:e})):(g.onWriteLog("info","follow",e,"follow"),b.value=0);if(e.data.length){const t=e.data[0].position;_.value=e.data[0].distance.toFixed(2),function(e,t){const s=Math.atan2(e,t)*(180/Math.PI),o=document.getElementById("rotate-bg");o&&(o.style.transform=`rotateZ(${s}deg)`)}(t[0],t[1])}e.messageInfo&&(S.device=e.messageInfo.device,S.deviceId="-1"!==e.messageInfo.deviceId?e.messageInfo.deviceId:"",S.band=e.messageInfo.band,S.errCode=e.messageInfo.errCode)}))})),j((()=>{for(Pe();Me.length;)Me.pop()()}));const Ye=()=>{(3!=S.follow_target_mode||1===S.device&&1===S.band)&&Ge().then((e=>{if(e){o.getInstance().sendLaserData({enable_topic:"/laser_state"});const e={max_forward_velocity:r.customSetting.followSetting.max_forward_velocity,max_angular_velocity:r.customSetting.followSetting.max_angular_velocity,max_forward_acc:r.customSetting.followSetting.max_forward_acc,max_angular_acc:r.customSetting.followSetting.max_angular_acc};3==S.follow_target_mode&&(e.runMode=S.runType?2:1),o.getInstance().sendLaserData({topic:"/laser_state",cmd:"follow.start",followType:S.follow_target_mode,extra:e})}}))},Pe=()=>{o.getInstance().sendLaserData({topic:"/laser_state",cmd:"follow.stop"}),1==S.follow_target_mode&&setTimeout((()=>{b.value=0}),300)};const Ze=x({show:!1,showResolve:null,type:1,errCode:"",errMessage:""});function Ke(){const e=a.offlineSetting.followSetting||{};e.runMode=S.runType?2:1,a.offlineSetting.followSetting=e,l.getInstance().setOfflineSetting(a.offlineSetting)}const Ge=()=>new Promise(((e,t)=>{r.robotstate.battery<=r.customSetting.otherSetting.forceBattery?(Ze.showResolve=e,i.show({data:{errText:n.global.t("starup.ts"),errInfo:n.global.t("starup.dqdlgdqcdhzsygsgn"),errType:129},sureText:n.global.t("index.qd")})):S.runType&&3==S.follow_target_mode?(Ze.showResolve=e,Ze.show=!0,Ze.type=1):e(!0)})),He=()=>{Ze.showResolve(!1),Ze.show=!1},Le=()=>{Ze.showResolve(!0),Ze.show=!1};return(e,t)=>(E(),I("div",Y,[[2,3].includes(q(S).follow_target_mode)?(E(),I("div",P,[A("p",{class:C({"err-text":1!==q(S).device})},k(e.$t("index.dwsblj"))+"："+k(q(Q)),3),A("p",{class:C({"err-text":1!==q(S).band})},k(e.$t("index.gsshxh"))+"："+k(q(Fe)),3),A("p",{class:C({"err-text":!q(S).deviceId})},k(e.$t("index.shId"))+"："+k(q(S).deviceId||e.$t("index.wu")),3),A("p",Z,[A("span",null,k(e.$t("follow.jsms"))+":",1),K,R(M,{class:"switch-box",onChangeSwitch:Ke,disabled:![0,4,5].includes(q(b)),modelValue:q(S).runType,"onUpdate:modelValue":t[0]||(t[0]=e=>q(S).runType=e)},null,8,["disabled","modelValue"])])])):B("",!0),A("div",G,[0===q(b)?(E(),I("div",H,[A("p",L,k(e.$t("index.jqrddsbmbqzzjqrqf")),1),A("p",N,k(e.$t("index.dqmymb")),1)])):1===q(b)?(E(),I("div",O,[A("p",W,k(e.$t("index.jqrzzsbmbqzaqqrqfbqkfjqtzaw")),1),A("p",J,k(e.$t("index.zzsbz")),1)])):[2,3].includes(q(b))?(E(),I("div",V,[A("p",X,k(e.$t("setting.zzgsz")),1),A("p",$,k(e.$t("index.ysbmb")),1)])):[4].includes(q(b))?(E(),I("div",ee,[A("p",te,k(e.$t("index.jqrdsmbqzzjqrqf")),1),A("p",se,k(e.$t("index.mbds")),1)])):[5].includes(q(b))?(E(),I("div",oe,[A("p",ae,k(e.$t("index.sbsbqjcjqrhmbsfcydtnbqcsyc")),1),A("p",le,k(e.$t("index.sbsb")),1)])):B("",!0),A("div",ie,[A("div",{class:C(["rotate-bg",{step2:[2,3].includes(q(b)),step4:[4].includes(q(b))}]),id:"rotate-bg"},null,2),ne])]),A("div",de,[0===q(b)?(E(),I("div",{key:0,class:C(["btn",{disabled:[2,3].includes(q(S).follow_target_mode)&&(1!==q(S).device||1!==q(S).band)}])},[A("span",{onClick:Ye},k(e.$t("index.kssb")),1)],2)):1===q(b)?(E(),I("div",re,[A("span",null,k(e.$t("index.zzsbqsh")),1)])):2===q(b)?(E(),I("div",ce,[A("div",fe,[A("span",null,k(e.$t("index.cxsb")),1)]),A("div",pe,[A("span",null,k(e.$t("index.ksgs")),1)])])):3===q(b)?(E(),I("div",me,[A("span",{onClick:Pe},k(e.$t("index.tzgs")),1)])):4===q(b)?(E(),I("div",ge,[A("span",{onClick:Ye},k(e.$t("index.kssb")),1)])):5===q(b)?(E(),I("div",we,[A("span",{onClick:Ye},k(e.$t("index.cxsb")),1)])):B("",!0)]),q(T)?(E(),I("div",ue,[A("div",be,[ve,A("div",xe,[A("div",{onClick:t[1]||(t[1]=e=>z(T)?T.value=!1:T=!1)},k(e.$t("setting.fh")),1),A("div",{onClick:t[2]||(t[2]=e=>z(T)?T.value=!1:T=!1)},k(e.$t("重新连接")),1),A("div",{onClick:t[3]||(t[3]=e=>z(T)?T.value=!1:T=!1),class:"active"},k(e.$t("继续跟随")),1)])])])):B("",!0),q(r).robotstate.isEmergencyStop?(E(),I("div",ye,[R(U)])):B("",!0),Ze.show?(E(),I("div",he,[1===Ze.type?(E(),I("div",je,[A("h3",Ie,[A("span",null,k(e.$t("starup.ts")),1),qe,A("div",{class:"close-box",onClick:t[4]||(t[4]=e=>Ze.show=!1)},Ae)]),A("div",ke,[A("p",Ce,k(e.$t("task.dqcyjsmsxssddftsczpzfxzhjmjdxzqyqjssy")),1)]),A("div",Re,[A("div",{class:"cancel-list-btn",onClick:He},k(e.$t("index.qx")),1),A("div",{class:"sure-list-btn",onClick:Le},k(e.$t("index.qd")),1)])])):B("",!0),2===Ze.type?(E(),I("div",Be,[A("div",ze,k(e.$t("starup.yc")),1),_e,A("div",{class:"tip1starup",innerHTML:Ze.errMessage||"--"},null,8,Te),A("div",Se,k(e.$t("setting.gzdm"))+":"+k(Ze.errCode),1),A("div",Ee,[A("div",{class:"cancel-list-btn",onClick:t[5]||(t[5]=e=>Ze.show=!1)},k(e.$t("emerge.wzdl")),1)])])):B("",!0)])):B("",!0)]))}}),[["__scopeId","data-v-e180777e"]]);export{Ue as default};
