import{C as e,r as t,W as l,e as o,y as i,aZ as s,a1 as a,w as r,c as n,I as d,J as c,a as u,M as p,u as m,K as f,L as v,a3 as g,R as h,P as b,O as y,T as S,o as k,U as w,b3 as _,b2 as x}from"./@vue-73fba911.js";import{_ as I}from"./floorl-cd6ae1bf.js";import{S as j,a as C}from"./swiper-276df855.js";import{d as E}from"./vuedraggable-2cae6a79.js";import{B as N}from"./bookmark-8c5bb33e.js";import{D as L}from"./delivery-box-a21efe7d.js";import{I as P}from"./iframePage-64a37c0a.js";import{y as T,ai as B,aA as M,aB as R,$ as O,ah as A,aC as D,T as W,t as $,aD as z,aE as J,aq as U,P as V,aF as q,aG as K,aH as F,aI as G,at as H,_ as Z}from"./index-d6250428.js";import{u as Q}from"./vue-i18n-5829ac11.js";import"./ssr-window-792d0f84.js";import"./dom7-250848e3.js";import"./@autoxing-9bbbdd2d.js";import"./axios-2c1be958.js";import"./websocket-963e06e0.js";import"./es5-ext-689fde2c.js";import"./vue-6ec50eb9.js";import"./sortablejs-5a5a189d.js";import"./slide-368d8d5f.js";import"./pinia-118dd6fd.js";import"./vue-router-fe18c2fe.js";import"./element-plus-5a8aeb67.js";import"./dayjs-4c03de08.js";import"./lodash-es-fa68f30b.js";import"./@vueuse-171ed302.js";import"./@element-plus-c72353dc.js";import"./@ctrl-ee9bdfd4.js";import"./async-validator-efc2d198.js";import"./@popperjs-892fd7f5.js";import"./escape-html-4bbaf1e1.js";import"./normalize-wheel-es-da779ce4.js";import"./vue3-loading-overlay-a6191c09.js";import"./vue-slider-component-7621b196.js";import"./mitt-dab1f1cb.js";import"./amfe-flexible-1f7bb7f4.js";import"./@intlify-352b7567.js";const X=e=>(_("data-v-02878eec"),e=e(),x(),e),Y={class:"multideliverycontent"},ee={class:"common-box"},te={class:"multitop"},le=[X((()=>u("img",{src:I,style:{width:"13px",height:"21px"}},null,-1)))],oe={key:1,class:"floor_list2",id:"scroll1"},ie=["id","onClick"],se=[X((()=>u("img",{class:"rotate180",src:I,style:{width:"13px",height:"21px"}},null,-1)))],ae=[X((()=>u("img",{src:I,style:{width:"13px",height:"21px"}},null,-1)))],re={class:"floor_list2",id:"scroll2"},ne=["id","onClick"],de=[X((()=>u("img",{class:"rotate180",src:I,style:{width:"13px",height:"21px"}},null,-1)))],ce={class:"mu_point_list"},ue={class:"left_pre",style:{"margin-top":"-12px"}},pe={key:0,class:"left_center"},me={class:"mu_swiper_content"},fe=["onClick"],ve={key:1,class:"left_center"},ge=["onClick"],he={class:"right_pre",style:{"margin-top":"-12px"}},be={class:"mu_dot"},ye={key:0,class:"dotscontent"},Se={key:1,class:"dotscontent"},ke={class:"mu_sel_point"},we={class:"mu_sel_left"},_e={style:{position:"relative"},class:"draf_cont-box"},xe={class:"draf_cont1",style:{display:"flex","align-items":"center"}},Ie=X((()=>u("div",{class:"one_drag"},null,-1))),je={key:0,style:{width:"30px",height:"30px",display:"flex","align-items":"center"}},Ce={style:{position:"absolute",top:"0",right:"0",left:"0",bottom:"0","overflow-y":"hidden","overflow-x":"auto"}},Ee={class:"one_drag"},Ne=X((()=>u("div",{style:{width:"31px"}},null,-1))),Le={class:"start-box"},Pe={key:0},Te={key:1},Be=e({beforeRouteEnter(e,t,l){l((e=>{const t=e;if(t.userstore&&t.userstore.isModify){B().list.forEach(((e,l)=>{3==e.status&&t.multidelist.forEach(((l,o)=>{if(l.id==e.id){let e=l;1==e.select&&(e.select=0,t.multidelist.splice(o,1))}}))}))}else t.cleanMessage();t.initscroll()}))}}),Me=Z(e({...Be,__name:"Multidelivery",setup(e,{expose:_}){const{t:x}=Q(),I=T(),B=t(1);let Z=z[1];const X=l([]),Be=t(!1),Me=t(!1),Re=t(!1),Oe=t(!1),Ae=t(!1),De=t(!1);let We=null,$e=null,ze=t(null);o((()=>{var e=document.getElementById("scroll1");e&&e.addEventListener("scroll",(function(){e.scrollLeft<=10?0==Re.value&&(Re.value=!0):1==Re.value&&(Re.value=!1),e.scrollWidth-e.offsetWidth-e.scrollLeft<=10?0==Oe.value&&(Oe.value=!0):1==Oe.value&&(Oe.value=!1)}));var t=document.getElementById("scroll2");t&&t.addEventListener("scroll",(function(){t.scrollLeft<=10?0==Ae.value&&(Ae.value=!0):1==Ae.value&&(Ae.value=!1),t.scrollWidth-t.offsetWidth-t.scrollLeft<=10?0==De.value&&(De.value=!0):1==De.value&&(De.value=!1)}))})),i((()=>{var e=document.getElementById("scroll1");e&&e.removeEventListener("scroll",null);var t=document.getElementById("scroll2");t&&t.removeEventListener("scroll",null)}));const Je=t(!1),Ue=t(100);s((()=>{Ze(U.value),function(){Je.value=!1,Ue.value++;const e=localStorage.getItem("bookmarkData");if(e){const t=JSON.parse(e);console.log(t,"localBookmarkMap");let l={};const o=localStorage.getItem("areaId");q?l=t.elevator||{}:o&&(l=t[o]||{}),l.floorlist&&l.floorlist.length&&(Je.value=!0)}}()})),a((()=>{V.getInstance().onDeactivated()}));const Ve=e=>{console.log(e),delete e.orderId,delete e.url,1==e.select?(e.select=0,X.forEach(((t,l)=>{e.id==t.id&&X.splice(l,1)}))):(console.log(!!X),X&&(e.select=1,X.push(e),ze.value.showIframe(e).then((t=>{t&&(e.orderId=t.orderId,e.url=t.url)})))),console.log(X)};function qe(e){if(1==e){document.getElementById("scroll1").scrollLeft-=60}else{document.getElementById("scroll1").scrollLeft+=69}}function Ke(e){if(1==e){document.getElementById("scroll2").scrollLeft-=60}else{document.getElementById("scroll2").scrollLeft+=69}}function Fe(e){}function Ge(e){We=e}function He(e){$e=e}function Ze(e){if(1==B.value)for(let t in Z.boardlist){if((Z.boardlist[t][0].floorName?Z.boardlist[t][0].floorName:Z.boardlist[t][0].floor)==e){Z.swipertab=Number(t),We.slideTo(Number(t));break}}else for(let t in Z.boardlist2){if((Z.boardlist2[t][0].floorName?Z.boardlist2[t][0].floorName:Z.boardlist2[t][0].floor)==e){Z.swipertab2=Number(t),$e.slideTo(Number(t));break}}}function Qe(){if(Z.boardlist&&Z.boardlist.length&&Z.boardlist[Z.swipertab]&&Z.boardlist[Z.swipertab].length){let e=1==B.value?Z.floorlist:Z.floorlist2,t=1==B.value?Z.boardlist[Z.swipertab][0].floorName?Z.boardlist[Z.swipertab][0].floorName:Z.boardlist[Z.swipertab][0].floor:Z.boardlist2[Z.swipertab2][0].floorName?Z.boardlist2[Z.swipertab2][0].floorName:Z.boardlist2[Z.swipertab2][0].floor;for(let l in e)e[l].name==t?(e[l].sel=!0,at(Number(l))):e[l].sel=!1}}function Xe(){1==B.value?We.slidePrev():$e.slidePrev()}function Ye(){1==B.value?We.slideNext():$e.slideNext()}function et(e){Z.swipertab=e.activeIndex,Qe()}function tt(e){Z.swipertab2=e.activeIndex,Qe()}function lt(e,t){let l=(1==B.value?Z.boardlist:Z.boardlist2)[e][t];delete l.orderId,delete l.url,1==l.select?(l.select=0,X.forEach(((e,t)=>{l.id==e.id&&X.splice(t,1)}))):X&&(l.select=1,X.push(l),ze.value.showIframe(l).then((e=>{e&&(l.orderId=e.orderId,l.url=e.url)})))}function ot(){for(;X.length>0;){X.pop().select=0}}function it(e){let t=null,l=K[2];l&&l[e+""]&&(t=l[e+""]);let o={mode:R,audioId:O.audioIdset("3111002"),num:1,volume:I.customSetting.sound.switchon?I.customSetting.sound.voiceVolume:0,interval:-1,duration:-1,forcePlay:!0};return t&&(o.url=F(t.fileUrl),t.fileUrl&&(o.audioId=""),o.interval=t.ruleInterval,1==t.ruleType?o.num=t.ruleCount:2==t.ruleType&&(o.duration=t.ruleDuration)),o}function st(){let e=[];function t(t){e.push({x:t.coordinate[0],y:t.coordinate[1],yaw:t.yaw,areaId:t.areaId,dockingRadius:t.properties&&t.properties.dockingRadius?t.properties.dockingRadius:"1",ext:{name:t.name,id:t.id,orderId:t.orderId||null,url:t.url||null},stepActs:[{type:M.PlayAudio,data:it(t.id)},{type:M.OpenLight,data:{mode:1,color:I.customSetting.otherSetting.lightStrip.lightStripSwitch?I.customSetting.otherSetting.lightStrip.arriveState.lightColor:-1,feature:I.customSetting.otherSetting.lightStrip.arriveState.lightType}},{type:J(21)},{type:M.OpenLight,data:{mode:1,color:I.customSetting.otherSetting.lightStrip.lightStripSwitch?I.customSetting.otherSetting.lightStrip.taskState.lightColor:-1,feature:I.customSetting.otherSetting.lightStrip.taskState.lightType}}]})}for(let l=0;l<X.length;l++){let o=X[l];e.find((e=>e.ext.id==o.id))||t(o)}if(e.length>0){let t={};const l=localStorage.getItem("lineCallInfo");if(l&&I.customSetting.delivery.isLineCall){const e=JSON.parse(l).taskPt;if(e.length){const l=e[e.length-1];t={type:l.type,x:l.x,y:l.y,yaw:l.yaw,areaId:l.areaId,dockingRadius:l.stopRadius?l.stopRadius:"1",ext:{name:l.ext.name,id:l.ext.id},stepActs:[{type:M.OpenLight,data:{mode:1,color:I.customSetting.otherSetting.lightStrip.lightStripSwitch?I.customSetting.otherSetting.lightStrip.taskState.lightColor:-1,feature:I.customSetting.otherSetting.lightStrip.taskState.lightType}}]}}}let o={ext:{name:"起点"},stepActs:[{type:M.OpenLight,data:{mode:1,color:I.customSetting.otherSetting.lightStrip.lightStripSwitch?I.customSetting.otherSetting.lightStrip.taskState.lightColor:-1,feature:I.customSetting.otherSetting.lightStrip.taskState.lightType}},{type:M.PlayAudio,data:{mode:R,audioId:O.audioIdset(A()?"3112043":"3111012"),num:1,volume:I.customSetting.sound.switchon?I.customSetting.sound.voiceVolume:0,interval:-1,duration:-1,channel:1,forcePlay:!0}},{type:M.SetSpeed,data:{speed:I.customSetting.delivery.runSpeed/100}}]},i={name:"多点任务"+(new Date).getTime(),runNum:1,runMode:+(I.customSetting.basic.runMode||1),taskType:D(),runType:21,curPt:o,pts:e,backPt:t,ignorePublicSite:!0};W.getInstance().startTask(i)}else $.show(x("index.wxzzd"))}function at(e){var t=document.getElementById("id"+Number(e));t&&t.scrollIntoView({block:"center",inline:"center",behavior:"auto"})}return r((()=>G.value),((e,t)=>{Z.value=z[1],ot()})),r((()=>U.value),((e,t)=>{Ze(e)})),r((()=>H.value),((e,t)=>{2==I.businessScene&&(B.value=1)})),_({multidelist:X,userstore:I,cleanMessage:ot,initscroll:function(){let e=1==B.value?Z.floorlist:Z.floorlist2;for(let t in e)e[t].sel&&at(Number(t))}}),(e,t)=>(k(),n("div",Y,[d(u("div",ee,[u("div",te,[d(u("div",{class:p(m(Z).floorlist.length>0?"floor_content":"floor_content2")},[m(Z).floorlist.length>5?(k(),n("div",{key:0,class:p(Re.value?"floorleft_per1":"floorleft_per2"),onClick:t[0]||(t[0]=e=>qe(1))},le,2)):f("",!0),m(Z).floorlist.length>0?(k(),n("div",oe,[(k(!0),n(v,null,g(m(Z).floorlist,((e,t)=>(k(),n("div",{id:"id"+t,class:p(e.sel?"one_floor":"nosel_floor"),onClick:t=>Ze(e.name),key:t},S(e.name),11,ie)))),128))])):f("",!0),m(Z).floorlist.length>5?(k(),n("div",{key:2,class:p(Oe.value?"floorright_per1":"floorright_per2"),onClick:t[1]||(t[1]=e=>qe(2))},se,2)):f("",!0)],2),[[c,1==B.value]]),d(u("div",{class:p(m(Z).floorlist2.length>0?"floor_content":"floor_content2")},[m(Z).floorlist2.length>5?(k(),n("div",{key:0,class:p(Ae.value?"floorleft_per1":"floorleft_per2"),onClick:t[2]||(t[2]=e=>Ke(1))},ae,2)):f("",!0),u("div",re,[(k(!0),n(v,null,g(m(Z).floorlist2,((e,t)=>(k(),n("div",{id:"id"+t,class:p(e.sel?"one_floor":"nosel_floor"),onClick:t=>Ze(e.name),key:t},S(e.name),11,ne)))),128))]),m(Z).floorlist2.length>5?(k(),n("div",{key:1,class:p(De.value?"floorright_per1":"floorright_per2"),onClick:t[3]||(t[3]=e=>Ke(2))},de,2)):f("",!0)],2),[[c,2==B.value]])]),u("div",ce,[u("div",ue,[1==B.value&&m(Z).floorlist.length>0?(k(),n("span",{key:0,onClick:Xe,class:p([0==m(Z).swipertab?"disable-pre":"active-pre","swiper-button-prev"])},null,2)):f("",!0),2==B.value&&m(Z).floorlist2.length>0?(k(),n("span",{key:1,onClick:Xe,class:p([0==m(Z).swipertab2?"disable-pre":"active-pre","swiper-button-prev"])},null,2)):f("",!0)]),1==B.value?(k(),n("div",pe,[u("div",me,[h(m(j),{style:{width:"100%",height:"100%"},initialSlide:m(Z).swipertab,"slides-per-view":1,"space-between":50,onSwiper:Ge,onSlideChange:et},{default:b((()=>[(k(!0),n(v,null,g(m(Z).boardlist,((e,t)=>(k(),y(m(C),{key:t,class:"slideone"},{default:b((()=>[(k(!0),n(v,null,g(e,((e,l)=>(k(),n("div",{key:l,onClick:e=>lt(t,l),class:p(1==e.select?"mu_one_Point font1":"mu_one_Point2 font1"),style:w(e.name?"":"display:none")},[u("span",null,S(e.name),1)],14,fe)))),128))])),_:2},1024)))),128))])),_:1},8,["initialSlide"])])])):f("",!0),2==B.value?(k(),n("div",ve,[h(m(j),{style:{width:"100%",height:"100%"},initialSlide:m(Z).swipertab2,"slides-per-view":1,"space-between":50,onSwiper:He,onSlideChange:tt},{default:b((()=>[(k(!0),n(v,null,g(m(Z).boardlist2,((e,t)=>(k(),y(m(C),{class:"mu_swiper_content",key:t},{default:b((()=>[(k(!0),n(v,null,g(e,((e,l)=>(k(),n("div",{key:l,onClick:e=>lt(t,l),class:p(1==e.select?"mu_one_Point font1":"mu_one_Point2 font1"),style:w(e.name?"":"display:none")},[u("span",null,S(e.name),1)],14,ge)))),128))])),_:2},1024)))),128))])),_:1},8,["initialSlide"])])):f("",!0),u("div",he,[1==B.value&&m(Z).floorlist.length>0?(k(),n("span",{key:0,onClick:Ye,class:p([m(Z).swipertab==m(Z).boardlist.length-1?"disable-pre":"active-pre","swiper-button-next"])},null,2)):f("",!0),2==B.value&&m(Z).floorlist2.length>0?(k(),n("span",{key:1,onClick:Ye,class:p([m(Z).swipertab2==m(Z).boardlist2.length-1?"disable-pre":"active-pre","swiper-button-next"])},null,2)):f("",!0)])]),u("div",be,[1==B.value?(k(),n("div",ye,[(k(!0),n(v,null,g(m(Z).boardlist,((e,t)=>(k(),n("div",{class:p(t==m(Z).swipertab?"one_dot":"one_dot2")},null,2)))),256))])):f("",!0),2==B.value?(k(),n("div",Se,[(k(!0),n(v,null,g(m(Z).boardlist2,((e,t)=>(k(),n("div",{class:p(t==m(Z).swipertab2?"one_dot":"one_dot2")},null,2)))),256))])):f("",!0)])],512),[[c,!Je.value]]),Je.value?(k(),y(N,{key:Ue.value,isBookmarkType:Je.value,onSelectPosition:Ve},null,8,["isBookmarkType"])):f("",!0),u("div",ke,[u("div",we,[u("div",_e,[u("div",xe,[(k(!0),n(v,null,g(X,((e,t)=>(k(),n("div",{key:t,style:{display:"flex","align-items":"center"}},[Ie,t<X.length-1?(k(),n("div",je)):f("",!0)])))),128))]),u("div",Ce,[h(m(E),{list:X,disabled:!Be.value,class:"draf_cont","ghost-class":"ghost",move:Fe,onStart:t[4]||(t[4]=e=>Me.value=!0),itemKey:"multidelist.id",onEnd:t[5]||(t[5]=e=>Me.value=!1)},{item:b((({element:e})=>[u("div",{style:{display:"flex"},class:p({"not-draggable":!Be.value})},[u("div",Ee,S(e.name.length>=4?e.name.slice(0,4)+"...":e.name)+S(" ->"),1),Ne],2)])),_:1},8,["list","disabled"])])]),u("div",{class:"clean_cont",onClick:ot},S(e.$t("index.qk")),1)]),u("div",Le,[h(L),u("div",{class:"mu_sel_right font1",onClick:st},[m(I).isModify?(k(),n("span",Pe,S(e.$t("index.xgrw")),1)):(k(),n("span",Te,S(e.$t("index.ljcf")),1))])])]),h(P,{ref_key:"IframeComponent",ref:ze,pageType:1},null,512)]))}}),[["__scopeId","data-v-02878eec"]]);export{Me as default};
