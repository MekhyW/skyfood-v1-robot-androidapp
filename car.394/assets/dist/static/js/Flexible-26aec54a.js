import{c as s}from"./element-plus-5a8aeb67.js";import{y as e,aA as i,aB as t,$ as a,T as n,R as l,t as o,Q as c,aR as r,b5 as p,g as d,aF as u,_ as m}from"./index-d6250428.js";import{D as g}from"./delivery-box-a21efe7d.js";import{C as k,r as j,W as v,aZ as h,c as y,a as b,T as f,L as x,a3 as I,M as L,R as P,P as w,o as S,K as A,u as C,a4 as q,b3 as E,b2 as $}from"./@vue-73fba911.js";import"./dayjs-4c03de08.js";import"./@autoxing-9bbbdd2d.js";import"./axios-2c1be958.js";import"./websocket-963e06e0.js";import"./es5-ext-689fde2c.js";import"./lodash-es-fa68f30b.js";import"./@vueuse-171ed302.js";import"./@element-plus-c72353dc.js";import"./@ctrl-ee9bdfd4.js";import"./async-validator-efc2d198.js";import"./@popperjs-892fd7f5.js";import"./escape-html-4bbaf1e1.js";import"./normalize-wheel-es-da779ce4.js";import"./vue-router-fe18c2fe.js";import"./vue-i18n-5829ac11.js";import"./@intlify-352b7567.js";import"./pinia-118dd6fd.js";import"./vue3-loading-overlay-a6191c09.js";import"./vue-slider-component-7621b196.js";import"./vue-6ec50eb9.js";import"./mitt-dab1f1cb.js";import"./swiper-276df855.js";import"./ssr-window-792d0f84.js";import"./dom7-250848e3.js";import"./amfe-flexible-1f7bb7f4.js";const z=s=>(E("data-v-f7007253"),s=s(),$(),s),T={class:"flexible-box"},R={class:"poi-con-box"},_={class:"jacking-poi poi-box"},M={class:"title"},V={class:"overlay-sroll"},D={key:0,class:"poi-list"},F=["onClick"],B={key:1,class:"poi-list"},K=["onClick"],N={class:"select-poi"},O={class:"task-list",ref:"taskList"},Q={class:"info max-10"},W=q(),Z={key:0},G=z((()=>b("span",{class:"add-box"},[b("i")],-1))),H={class:"info"},J={key:0,class:"poi-name"},U=["onClick"],X={key:0},Y={key:1},ss={class:"select-box"},es=["src"],is={class:"push-poi poi-box"},ts={class:"title"},as={class:"overlay-sroll"},ns={key:0,class:"poi-list"},ls=["onClick"],os={key:1,class:"poi-list"},cs=["onClick"],rs={class:"start-task-box"},ps=m(k({__name:"Flexible",setup(m){const k=e(),q=j(!1);let E=j("");const $=v({list:[],curError:-1,areaList:[],pushList:[],jackList:[]});h((()=>{$.list=[],$.curError=-1,z()}));const z=()=>{const s={businessId:d.businessId,isRelatedShelves:!0,areaId:""};u||(s.areaId=localStorage.getItem("areaId")||""),l.getInstance().getShelvesAreaList(s).then((s=>{console.log(s.data),s&&200===s.status&&($.areaList=s.data)}))};function ps(s){return s.properties=Object.assign({},s.properties),[34].includes(s.type)&&(s.properties.subtype||(s.properties.subtype="rack")),s}const ds=(s,e,i)=>{const t=$.list[0]||{};"jacking"===e?($.jackList=s.poiList.filter((s=>34==(s=ps(s)).type&&s.properties&&s.properties.subtype===(8===k.robotType?"pallet":"rack"))),t.jacking&&t.jacking.id!==s.id&&(t.jackingPoi=null)):"pushing"===e&&($.pushList=s.poiList.filter((s=>34==(s=ps(s)).type&&s.properties&&s.properties.subtype===(8===k.robotType?"pallet":"rack"))),t.pushing&&t.pushing.id!==s.id&&(t.pushingPoi=null)),t[e]=s,$.list[0]=t,$.curError=-1},us=()=>{q.value=!q.value},ms=()=>{let s=[];function e(s,e){return{x:s.coordinate[0],y:s.coordinate[1],yaw:s.yaw,type:s.type,areaId:s.areaId,dockingRadius:s.properties&&s.properties.dockingRadius?s.properties.dockingRadius:"1",ext:{name:s.name,id:s.id},stepActs:[{type:i.PlayAudio,data:{mode:t,audioId:a.audioIdset(47===e?"3112044":"3112046"),num:1,volume:k.customSetting.sound.switchon?k.customSetting.sound.voiceVolume:0,interval:-1,duration:-1,channel:1}},{type:e,data:{}},{type:i.PlayAudio,data:{mode:t,audioId:a.audioIdset(47===e?"3112045":"3112043"),num:1,volume:k.customSetting.sound.switchon?k.customSetting.sound.voiceVolume:0,interval:-1,duration:-1,channel:1}}]}}if($.list.length&&!(()=>{let s=!1;return E.value="index.qwsdqsjx",$.list.map(((e,i)=>{s||(e.jacking?e.pushing?q.value||$.jackList.length&&$.pushList.length?e.jacking.id===e.pushing.id&&($.curError=i,s=!0,E.value="index.qxzbtdqy"):($.curError=i,E.value="index.dqqyxwzdsj",s=!0):($.curError=i,s=!0):(s=!0,$.curError=i))})),s})())if($.list.forEach(((t,a)=>{if(t.jacking){const i=e(t.jackingPoi||$.jackList.length&&$.jackList[0],47);i.ext.name=t.jacking.name,i.ext.index=2*a;const n={type:47,data:{index:2*a}};q.value?n.data.areaId=t.jacking.id:n.data.useAreaId=t.jacking.id,i.stepActs.splice(1,1,n),s.push(i)}if(t.pushing){const n=e(t.pushingPoi||$.pushList.length&&$.pushList[0],48);n.ext.name=t.pushing.name,n.ext.index=2*a+1;const l={type:48,data:{index:2*a+1}};q.value?l.data.areaId=t.pushing.id:l.data.useAreaId=t.pushing.id,n.stepActs.splice(1,1,l),n.stepActs.push({type:i.InterAction}),s.push(n)}})),s.length>0){let e={ext:{name:"起点"},stepActs:[{type:i.PlayAudio,data:{mode:t,audioId:a.audioIdset("3112043"),num:1,volume:k.customSetting.sound.switchon?k.customSetting.sound.voiceVolume:0,interval:-1,duration:-1,channel:1}},{type:i.SetSpeed,data:{speed:k.customSetting.delivery.runSpeed/100}}]},o={name:"灵活搬运"+(new Date).getTime(),runNum:9999,runMode:+(k.customSetting.basic.runMode||1),taskType:5,runType:31,curPt:e,pts:s,ignorePublicSite:!0};console.log(o),n.getInstance().startTask(o),l.getInstance().setSmoothLevel(localStorage.getItem("deliveryType"))}else o.show(c.global.t("index.wxzzd"))};return(e,i)=>{const t=s;return S(),y("div",T,[b("div",R,[b("div",_,[b("p",M,f(q.value&&$.list[0]&&$.list[0].jacking?e.$t("index.dsz"):e.$t("index.qhqy")),1),b("div",V,[q.value&&$.list[0]&&$.list[0].jacking?(S(),y("div",D,[(S(!0),y(x,null,I($.jackList,((s,e)=>(S(),y("p",{class:L(["btn",{active:$.list[0]&&$.list[0].jackingPoi&&$.list[0].jackingPoi.id===s.id}]),key:e,onClick:e=>ds(s,"jackingPoi")},f(s.name||"--"),11,F)))),128))])):(S(),y("div",B,[(S(!0),y(x,null,I($.areaList,((s,e)=>(S(),y("p",{class:L(["btn",{active:s.id===($.list[0]&&$.list[0].jacking&&$.list[0].jacking.id)}]),key:e,onClick:e=>ds(s,"jacking")},f(s.name||"--"),11,K)))),128))]))])]),b("div",N,[b("div",O,[(S(!0),y(x,null,I($.list,((s,i)=>(S(),y("div",{class:L(["select-item",{"error-row":i===$.curError}])},[b("p",null,[b("span",Q,[b("span",null,f(s.jacking&&s.jacking.name),1),W,q.value?(S(),y("span",Z,f(s.jackingPoi&&s.jackingPoi.name),1)):A("",!0)]),G,b("span",H,[b("span",null,f(s.pushing&&s.pushing.name),1),q.value?(S(),y("span",J,f(s.pushingPoi&&s.pushingPoi.name),1)):A("",!0)]),b("img",{class:"del-el",src:r,alt:"",onClick:s=>((s,e)=>{$.list.splice(e,1)})(0,i)},null,8,U),i===$.curError?(S(),y("span",{key:0,class:L(["err-text",q.value?"err-text-large":""])},[$.jackList.length&&$.pushList.length?(S(),y("span",Y,f(e.$t(C(E))),1)):(S(),y("span",X,f(e.$t(C(E))),1))],2)):A("",!0)])],2)))),256))],512),b("div",ss,[b("div",{class:"select-left",onClick:us},[b("span",{class:L(["no-select",{active:q.value}])},null,2),b("span",null,f(e.$t("index.zdhj")),1)]),P(t,{class:"box-item-tip",effect:"light",content:e.$t("index.xzhkyyxqwgqynzddhjd"),placement:"top",teleported:!1},{default:w((()=>[b("img",{class:"tip-message",src:C(p),alt:""},null,8,es)])),_:1},8,["content"])])]),b("div",is,[b("p",ts,f(q.value&&$.list[0]&&$.list[0].pushing?e.$t("index.fhd"):e.$t("index.fhqy")),1),b("div",as,[q.value&&$.list[0]&&$.list[0].pushing?(S(),y("div",ns,[(S(!0),y(x,null,I($.pushList,((s,e)=>(S(),y("p",{class:L(["btn",{active:s.id===($.list[0]&&$.list[0].pushingPoi&&$.list[0].pushingPoi.id)}]),key:e,onClick:e=>ds(s,"pushingPoi")},f(s.name||"--"),11,ls)))),128))])):(S(),y("div",os,[(S(!0),y(x,null,I($.areaList,((s,e)=>(S(),y("p",{class:L(["btn",{active:s.id===($.list[0]&&$.list[0].pushing&&$.list[0].pushing.id)}]),key:e,onClick:e=>ds(s,"pushing")},f(s.name||"--"),11,cs)))),128))]))])])]),b("div",rs,[P(g),b("p",{class:"start-task btn",onClick:ms},f(e.$t("index.ljcf")),1)])])}}}),[["__scopeId","data-v-f7007253"]]);export{ps as default};
