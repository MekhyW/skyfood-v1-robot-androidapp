import{e}from"./element-plus-5a8aeb67.js";import{C as s,r as a,e as l,w as i,v as t,o,c as n,a as c,T as u,L as r,a3 as d,M as p,u as v,K as m,I as P,ag as S,z as b,a4 as g,b3 as f,b2 as C,W as w,p as y,O as h,R as x,J as E}from"./@vue-73fba911.js";import{_ as j,a as T,b as A,c as K}from"./wifi_1-1973288c.js";import{w as N,L as W,a as k,t as M,b as O,_ as I,r as J,c as _,d as $,R as q,g as z,i as V,E as L,S as R,e as G,f as U,h as B,s as Z,j as H,k as X,l as D,o as F,m as Q,n as Y,p as ee,q as se,u as ae,v as le}from"./index-d6250428.js";import{u as ie}from"./vue-i18n-5829ac11.js";import"./dayjs-4c03de08.js";import"./@autoxing-9bbbdd2d.js";import"./axios-2c1be958.js";import"./websocket-963e06e0.js";import"./es5-ext-689fde2c.js";import"./lodash-es-fa68f30b.js";import"./@vueuse-171ed302.js";import"./@element-plus-c72353dc.js";import"./@ctrl-ee9bdfd4.js";import"./async-validator-efc2d198.js";import"./@popperjs-892fd7f5.js";import"./escape-html-4bbaf1e1.js";import"./normalize-wheel-es-da779ce4.js";import"./vue-router-fe18c2fe.js";import"./pinia-118dd6fd.js";import"./vue3-loading-overlay-a6191c09.js";import"./vue-slider-component-7621b196.js";import"./vue-6ec50eb9.js";import"./mitt-dab1f1cb.js";import"./swiper-276df855.js";import"./ssr-window-792d0f84.js";import"./dom7-250848e3.js";import"./amfe-flexible-1f7bb7f4.js";import"./@intlify-352b7567.js";const te=""+new URL("../png/xcx_sm-aae02a89.png",import.meta.url).href,oe=""+new URL("../gif/setting_success-c4f23b09.gif",import.meta.url).href,ne=e=>(f("data-v-e1788213"),e=e(),C(),e),ce={class:"step-box"},ue={class:"title"},re={class:"use-mobile"},de=g(),pe=ne((()=>c("i",null,null,-1))),ve={class:"list-box"},me=["onClick"],Pe={class:"img-box"},Se={class:"subtitle"},be={key:0,class:"icon-img",src:j},ge={key:1,class:"icon-img",src:T},fe={key:2,class:"icon-img",src:A},Ce={key:3,class:"icon-img",src:K},we={key:0,class:"model_on"},ye={class:"on1"},he=["placeholder"],xe={class:"bottom_tip"},Ee=I(s({__name:"wifiSetting",emits:["stepNext"],setup(e,{expose:s,emit:g}){const{t:f}=ie();let C,w=null,y=a([]),h=a(""),x=a(""),E=a(0);l((()=>{console.log("组件激活1"),N(JSON.stringify({event:"openBroadcast"})),T(),C=i((()=>O.value),((e,s)=>{if(e=e||{},console.log("111newValue=>"+JSON.stringify(e)),W.logmsg("111newValue=>",JSON.stringify(e)),"wifi_enable"==e.event){3==parseInt(e.data)?j():N(JSON.stringify({event:"setEnable",enable:!0}))}else"wifi_state"==e.event?"CONNECTED"==e.data&&(j(),clearTimeout(q)):"wifi_password"==e.event&&(k.close(),"error"==e.data&&(clearTimeout(q),clearTimeout(w),clearTimeout(_),w=setTimeout((()=>{M.fail(f("wifi.mmcw")),j()}),1e3)))}))})),t((()=>{console.log("组件销毁1"),C=null,clearTimeout(q),clearTimeout(w),clearTimeout(_),N(JSON.stringify({event:" closeBroadcast"}))}));const j=()=>{let e=N(JSON.stringify({event:"info"}));console.log("wifiinfo=>"+e),e&&JSON.parse(e).data?x.value=JSON.parse(e).data:x.value="",console.log("wifiName=>"+x.value),A()},T=()=>{let e=N(JSON.stringify({event:"enable"}));e=e?JSON.parse(e):{},console.log("====onWifeEnable"+JSON.stringify(e)),A(),e.data?j():N(JSON.stringify({event:"setEnable",enable:!0}))},A=()=>{let e=N(JSON.stringify({event:"list"}));e=e?JSON.parse(e):{data:[{capabilities:"[WPA2-PSK-CCMP][WPA-PSK-CCMP][ESS]",level:2,ssid:"TP-LINK_B3B3"},{capabilities:"[WPA-PSK-CCMP][WPA2-PSK-CCMP][ESS]",level:2,ssid:"lim-router"},{capabilities:"[WPA2-PSK-CCMP+TKIP][WPA-PSK-CCMP+TKIP][ESS]",level:2,ssid:"AutoXing"},{capabilities:"[WPA2-PSK-CCMP][ESS]",level:2,ssid:"AutoXing-guest"},{capabilities:"[WPA2-PSK-CCMP+TKIP][WPA-PSK-CCMP+TKIP][ESS]",level:2,ssid:"robot-2.4G"},{capabilities:"[WPA-PSK-CCMP][WPA2-PSK-CCMP][ESS]",level:2,ssid:"TP-LINK_34C8"},{capabilities:"[ESS]",level:2,ssid:"AXPORTAL"},{capabilities:"[ESS]",level:2,ssid:"OrayBox-CBEE"},{capabilities:"[ESS]",level:1,ssid:"ugg-guest"},{capabilities:"[WPA-PSK-CCMP+TKIP][WPA2-PSK-CCMP+TKIP][ESS]",level:1,ssid:"RM"},{capabilities:"[WPA2-PSK-CCMP][ESS][WPS]",level:1,ssid:"Frank"},{capabilities:"[ESS]",level:1,ssid:"HG-Guest"},{capabilities:"[WPA2-PSK-CCMP][ESS]",level:1,ssid:"Earth"},{capabilities:"[WPA2-PSK-CCMP][ESS]",level:1,ssid:"HG-Mobile-Devices"},{capabilities:"[WPA-PSK-CCMP][WPA2-PSK-CCMP][ESS]",level:1,ssid:"hager215-2.4G"},{capabilities:"[WPA-PSK-CCMP+TKIP][ESS]",level:1,ssid:"61822012000771f"},{capabilities:"[WPA-PSK-CCMP][WPA2-PSK-CCMP][ESS]",level:1,ssid:"hager215-5G"},{capabilities:"[WPA-PSK-CCMP+TKIP][ESS]",level:1,ssid:"71822011000100a"},{capabilities:"[WPA2-EAP-CCMP][ESS]",level:0,ssid:"HG-Corporate-E"},{capabilities:"[WPA2-PSK-CCMP][ESS]",level:0,ssid:"COSEECO-4598"},{capabilities:"[WPA-PSK-CCMP][WPA2-PSK-CCMP][ESS]",level:0,ssid:"lanwan"},{capabilities:"[WPA2-PSK-CCMP][ESS]",level:0,ssid:"Earth-Guest"},{capabilities:"[WPA-PSK-CCMP][WPA2-PSK-CCMP][ESS]",level:0,ssid:"lanwan-guest"}]};const s=[];for(let a of e.data)a.capabilities.indexOf("EAP")>-1?(a.isPwd=!0,a.type="eap"):a.capabilities.indexOf("WPA")>-1?(a.isPwd=!0,a.type="wpa"):a.capabilities.indexOf("WEP")>-1?(a.isPwd=!0,a.type="wep"):a.isPwd=!1,s.push(a);y.value=s};let K=a({});const I=()=>{E.value=0,h.value=""},J=()=>{N(JSON.stringify({event:"forget",ssid:K.ssid})),x.value="",I()};let _=null;const $=()=>{let e=N(JSON.stringify({event:"info"}));console.log("timesWifiInfo=>"+e),e&&JSON.parse(e).data?(x.value=JSON.parse(e).data,clearTimeout(q),clearTimeout(_)):_=setTimeout((()=>{$()}),1e3)};let q=null;const z=()=>{clearTimeout(q),clearTimeout(w),h.value&&h.value.length>=8?(q=setTimeout((()=>{M.show(f("wifi.ljcs")),k.close()}),3e4),k.show(),console.log(JSON.stringify({event:"connect",ssid:K.value.ssid,password:h.value})),N(JSON.stringify({event:"connect",ssid:K.value.ssid,password:h.value})),I()):M.show(f("wifi.mmcdbndy"))},V=()=>{g("stepNext","mobile")};return s({onWifeEnable:T,wifeEvent:O,EventWath:C}),(e,s)=>(o(),n("div",ce,[c("h3",ue,u(e.$t("init.szwifi")),1),c("p",re,[c("span",{onClick:V},u(e.$t("init.ysjll")),1),de,pe]),c("ul",ve,[(o(!0),n(r,null,d(v(y),((s,a)=>(o(),n("li",{onClick:e=>(e=>{console.log(x,e),console.log(e),K.value=e,x.value==e.ssid?E.value=1:e.isPwd?E.value=2:(q=setTimeout((()=>{M.fail(f("wifi.ljcs")),clearTimeout(_),k.close()}),3e4),k.show(),N(JSON.stringify({event:"connect",ssid:e.ssid,password:""})),$())})(s)},[c("span",{class:p({activeText:s.ssid===v(x)})},u(s.ssid),3),c("span",Pe,[c("span",Se,u(s.ssid===v(x)?e.$t("wifi.ylj"):""),1),s.isPwd?(o(),n("img",be)):m("",!0),2===s.level?(o(),n("img",ge)):m("",!0),1===s.level?(o(),n("img",fe)):m("",!0),2!==s.level&&1!==s.level?(o(),n("img",Ce)):m("",!0)])],8,me)))),256))]),0!==v(E)?(o(),n("div",we,[c("div",ye,[c("div",null,u(v(K).ssid),1),c("div",{class:p(2===v(E)?"inp":"inp2")},[2===v(E)?P((o(),n("input",{key:0,type:"text",placeholder:e.$t("wifi.qsrmm"),"onUpdate:modelValue":s[0]||(s[0]=e=>b(h)?h.value=e:h=e)},null,8,he)),[[S,v(h)]]):m("",!0)],2),c("div",xe,[c("div",{onClick:I},u(e.$t("index.qx")),1),1===v(E)?(o(),n("div",{key:0,onClick:J},u(e.$t("wifi.wjwl")),1)):m("",!0),2===v(E)?(o(),n("div",{key:1,onClick:z},u(e.$t("wifi.lj")),1)):m("",!0)])])])):m("",!0)]))}}),[["__scopeId","data-v-e1788213"]]),je=e=>(f("data-v-c12a1c9e"),e=e(),C(),e),Te={class:"setting-box"},Ae={class:"set-box"},Ke={key:0,class:"step-box"},Ne={class:"title"},We={class:"list-box"},ke=["onClick"],Me={key:1,class:"step-box"},Oe={class:"title"},Ie={class:"list-box"},Je=["onClick"],_e={key:3,class:"step-box"},$e={class:"title"},qe={class:"sm-box"},ze=je((()=>c("img",{src:te,alt:""},null,-1))),Ve={key:4,class:"step-box"},Le={class:"title"},Re={class:"use-mobile"},Ge=g(),Ue=je((()=>c("i",null,null,-1))),Be={class:"box-email-box"},Ze={class:"err-tip"},He={key:5,class:"step-box"},Xe={class:"sm-box"},De=je((()=>c("img",{src:oe,alt:""},null,-1))),Fe={class:"btn-list"},Qe={key:6,class:"btn-list"},Ye=I(s({__name:"InitSetting",setup(s){const{locale:i,t:t}=ie(),S=a(0),b=J(),g=a(2==b.server_mode),f=w({userName:"",password:"",email:""}),C=e=>{$.replace({path:e})};l((()=>{}));const j=()=>{k.show();let e=q.getInstance();e.isInitRobot()||e.init().then((s=>e.connectRobot())).then((s=>(z.sn=s.robotId,V(s.robotId),e.setRobotSn(s.robotId),e.getToken()))).then((e=>{Y(e),k.close()})).catch((e=>{console.log("error=>"+JSON.stringify(e)),k.close(),e=L.parseError(e,L.UnKnown),R.show({data:{errCode:e.errCode,errText:e.errText},sureText:t("starup.cs"),sure:()=>{R.close(),j()}})}))};"0"==_("lauchType","0")?j():C("/starup");const T=y((()=>(0!=S.value||A.value)&&(1!=S.value||I.value)&&(4!=S.value||f.userName&&f.password&&f.email)?"":"no-pass")),A=a(""),K=e=>{A.value=e.value,localStorage.setItem("language",e.value),O(e.languageindex),i.value=e.value,q.getInstance().setLanguage({language:e.languageindex}).then((e=>{e||M.fail(t("setlan.szyysb"))})),1==ee()&&function(e){let s={robotId:z.sn,language:e};F.upload_setting(s).then((e=>{W.logmsg("setting:保存语言设置",e)}))}(e.languageindex)};const N=w({list:[]}),O=e=>{const s=se(e);N.list=s?JSON.parse(s):ae},I=a(""),te=()=>{S.value-=1,g.value&&3===S.value&&(S.value-=1),S.value<0&&(S.value=0)},oe=a(""),ne=()=>f.userName.length?/^([a-zA-Z0-9_-])+@([a-zA-Z0-9_-])+((\.[a-zA-Z0-9_-]{2,3}){1,2})$/.test(f.email)?f.password.length?(oe.value="",!0):(oe.value=t("init.qsrzqmm"),!1):(oe.value=t("init.qsrzqyx"),!1):(oe.value=t("init.qsrzqzh"),!1),ce=()=>{let e=q.getInstance();const s=_("initTime","");G("lauchType","1"),s||G("initTime",U()),k.show(),e.updateMap().then((e=>B())).then((()=>e.getState())).then((e=>{k.close(),C("/starup"),Z(e.areaId),H()})).catch((e=>{k.close(),C("/starup"),console.log("666666666=>"+JSON.stringify(e)),W.logmsg("更新地图Catch",e),e&&"100001"==e.errCode?(X(),H(),M.show(t("setting.gxwc"))):M.fail(t("setting.dtgxsb"))}))},ue=()=>{const e=_("initTime","");G("lauchType","1"),e||G("initTime",U()),C("/starup"),setTimeout((()=>{D("com.robot.drawmap","com.robot.drawmap.MainActivity")}),100)},re=e=>{"mobile"===e&&pe()},de=()=>{S.value+=1},pe=()=>{T.value||g.value&&4===S.value&&!ne()||(g.value&&4===S.value&&ne()?F.register({userName:f.userName,email:f.email,password:f.password,country:"",language:"",city:"",province:"",isVerifyEmail:!1}).then((e=>{S.value+=1})).catch((e=>{oe.value=t("starup.wjcdkywl")})):S.value+=1,g.value&&3===S.value&&(S.value+=1),g.value||4!==S.value||(S.value+=1),S.value>5&&(S.value=5))};return(s,a)=>{const l=e;return o(),n("div",Te,[c("div",Ae,[0===S.value?(o(),n("div",Ke,[c("h3",Ne,u(s.$t("setting.qhyy")),1),c("ul",We,[(o(!0),n(r,null,d(v(Q),((e,s)=>(o(),n("li",{onClick:s=>K(e)},[c("span",null,u(e.name),1),c("span",{class:p(["radio",{active:A.value===e.value}])},null,2)],8,ke)))),256))])])):m("",!0),1===S.value?(o(),n("div",Me,[c("h3",Oe,u(s.$t("init.xzsq")),1),c("ul",Ie,[(o(!0),n(r,null,d(N.list,((e,s)=>(o(),n("li",{onClick:s=>(e=>{I.value=e.value,console.log("timeZoneList=>"+JSON.stringify(I.value)),le(I.value)})(e)},[c("span",null,u(e.name),1),c("span",{class:p(["radio",{active:I.value===e.value}])},null,2)],8,Je)))),256))])])):m("",!0),2===S.value?(o(),h(Ee,{key:2,onStepNext:re})):m("",!0),3===S.value?(o(),n("div",_e,[c("h3",$e,u(s.$t("init.wxsmsq")),1),c("div",qe,[ze,c("span",null,u(s.$t("init.qsywxsmsqjqrqx")),1)])])):m("",!0),4===S.value?(o(),n("div",Ve,[c("h3",Le,u(s.$t("init.bdyx")),1),c("p",Re,[c("span",{onClick:de},u(s.$t("starup.tg")),1),Ge,Ue]),c("div",Be,[x(l,{class:"input-box",modelValue:f.userName,"onUpdate:modelValue":a[0]||(a[0]=e=>f.userName=e),placeholder:s.$t("init.qsrzh")},null,8,["modelValue","placeholder"]),x(l,{class:"input-box",modelValue:f.email,"onUpdate:modelValue":a[1]||(a[1]=e=>f.email=e),placeholder:s.$t("init.qsryx")},null,8,["modelValue","placeholder"]),x(l,{class:"input-box",type:"password",modelValue:f.password,"onUpdate:modelValue":a[2]||(a[2]=e=>f.password=e),placeholder:s.$t("init.qsrmm")},null,8,["modelValue","placeholder"])]),c("div",Ze,[c("span",null,u(oe.value),1)])])):m("",!0),5===S.value?(o(),n("div",He,[c("div",Xe,[De,c("span",null,u(s.$t("init.jhcg")),1)]),c("div",Fe,[c("span",{class:"async-btn",onClick:ce},u(s.$t("init.tbydt")),1),c("span",{class:"new-btn",onClick:ue},u(s.$t("init.xjdt")),1)])])):m("",!0),5!==S.value?(o(),n("div",Qe,[P(c("span",{class:"back",onClick:te},u(s.$t("init.syb")),513),[[E,0!==S.value]]),P(c("span",null,null,512),[[E,0==S.value]]),c("span",{class:p(["next",v(T)]),onClick:pe},u(s.$t("init.xyb")),3)])):m("",!0)])])}}}),[["__scopeId","data-v-c12a1c9e"]]);export{Ye as default};
