import{C as e,r as t,W as l,aZ as o,a1 as s,e as i,y as a,w as n,c as r,a as d,T as c,L as u,a3 as p,I as f,J as m,M as v,u as g,K as h,R as b,P as y,O as S,b3 as k,b2 as w,o as _,U as x,S as I,n as j}from"./@vue-73fba911.js";import{_ as C}from"./fastdeveryico1-eee468d9.js";import{_ as L}from"./floorl-cd6ae1bf.js";import{S as N,a as P}from"./swiper-276df855.js";import{y as T,ai as E,g as B,aA as O,aB as A,$ as M,aC as R,T as D,R as W,t as $,aD as z,aE as F,aq as V,P as J,aF as U,aG as q,aH as G,aI as H,at as K,_ as Z}from"./index-d6250428.js";import{B as Q}from"./bookmark-8c5bb33e.js";import{D as X}from"./delivery-box-a21efe7d.js";import{u as Y}from"./vue-i18n-5829ac11.js";import"./ssr-window-792d0f84.js";import"./dom7-250848e3.js";import"./vue-router-fe18c2fe.js";import"./pinia-118dd6fd.js";import"./element-plus-5a8aeb67.js";import"./dayjs-4c03de08.js";import"./@autoxing-9bbbdd2d.js";import"./axios-2c1be958.js";import"./websocket-963e06e0.js";import"./es5-ext-689fde2c.js";import"./lodash-es-fa68f30b.js";import"./@vueuse-171ed302.js";import"./@element-plus-c72353dc.js";import"./@ctrl-ee9bdfd4.js";import"./async-validator-efc2d198.js";import"./@popperjs-892fd7f5.js";import"./escape-html-4bbaf1e1.js";import"./normalize-wheel-es-da779ce4.js";import"./vue3-loading-overlay-a6191c09.js";import"./vue-slider-component-7621b196.js";import"./vue-6ec50eb9.js";import"./mitt-dab1f1cb.js";import"./amfe-flexible-1f7bb7f4.js";import"./@intlify-352b7567.js";import"./slide-368d8d5f.js";const ee=e=>(k("data-v-2996d2f5"),e=e(),w(),e),te={class:"content"},le={class:"index_left"},oe={class:"index_left_top"},se=ee((()=>d("div",null,null,-1))),ie=ee((()=>d("div",null,null,-1))),ae=["onClick"],ne={class:"layer1"},re={key:0,class:"layer2"},de=["onClick"],ce={key:1,class:"layer3 font3"},ue={key:2,class:"layer4 font3"},pe=ee((()=>d("div",{class:"layer5"},null,-1))),fe={class:"index_right",id:"floorid"},me={class:"common-box"},ve={class:"index_right_top"},ge=[ee((()=>d("img",{src:L,style:{width:"13px",height:"21px"}},null,-1)))],he={key:1,class:"floor_list2",id:"scroll1"},be=["id","onClick"],ye=[ee((()=>d("img",{class:"rotate180",src:L,style:{width:"13px",height:"21px"}},null,-1)))],Se=[ee((()=>d("img",{src:L,style:{width:"13px",height:"21px"}},null,-1)))],ke={class:"floor_list2",id:"scroll2"},we=["id","onClick"],_e=[ee((()=>d("img",{class:"rotate180",src:L,style:{width:"13px",height:"21px"}},null,-1)))],xe={class:"index_right_center"},Ie={class:"left_pre"},je={key:0,class:"left_center"},Ce={class:"swiper_content"},Le=["onClick"],Ne={class:"dots"},Pe={class:"dotscontent"},Te={key:1,class:"left_center"},Ee={class:"swiper_content"},Be=["onClick"],Oe={class:"dots"},Ae={class:"dotscontent"},Me={class:"right_pre"},Re={class:"start-box"},De={key:0},We={key:1},$e=e({beforeRouteEnter(e,t,l){l((e=>{const l=e;"/setting"==t.matched[0].path&&l.setpallent();let o=E();if(l.userstore&&l.userstore.isModify)o.pallet.forEach(((e,t)=>{3==e.status&&l.delectcurrent(l.pallet[t])}));else{for(let e in l.pallet)l.pallet[e].table&&l.delectcurrent(l.pallet[e]);for(let e of l.pallet)e.sel=!1;l.pallet[0].sel=!0}l.initscroll()}))}}),ze=Z(e({...$e,__name:"Fastdelivery",setup(e,{expose:k}){let w=[];const{t:L}=Y(),E=T(),Z=t(1),ee=z[0];let $e=null,ze=null;const Fe=t(!1),Ve=t(!1),Je=t(!1),Ue=t(!1),qe=[{sel:!1,taskStatus:0,table:null},{sel:!1,taskStatus:0,table:null},{sel:!1,taskStatus:0,table:null},{sel:!1,taskStatus:0,table:null}],Ge=l([]),He=t(!1),Ke=t(10);function Ze(){var e=document.getElementById("scroll1");if(e&&e.addEventListener("scroll",(function(){e.scrollLeft<=10?0==Fe.value&&(Fe.value=!0):1==Fe.value&&(Fe.value=!1),e.scrollWidth-e.offsetWidth-e.scrollLeft<=10?0==Ve.value&&(Ve.value=!0):1==Ve.value&&(Ve.value=!1)})),t){var t=document.getElementById("scroll2");t.addEventListener("scroll",(function(){t.scrollLeft<=10?0==Je.value&&(Je.value=!0):1==Je.value&&(Je.value=!1),t.scrollWidth-t.offsetWidth-t.scrollLeft<=10?0==Ue.value&&(Ue.value=!0):1==Ue.value&&(Ue.value=!1)}))}}o((()=>{j((()=>{rt(V.value)})),function(){He.value=!1,Ke.value++;const e=localStorage.getItem("bookmarkData");if(e){const t=JSON.parse(e);console.log(t,"localBookmarkMap");let l={};const o=localStorage.getItem("areaId");U?l=t.elevator||{}:o&&(l=t[o]||{}),l.floorlist&&l.floorlist.length&&(He.value=!0)}}()})),s((()=>{J.getInstance().onDeactivated()})),i((()=>{Ze()})),a((()=>{var e=document.getElementById("scroll1");e&&e.removeEventListener("scroll",null);var t=document.getElementById("scroll2");t&&t.removeEventListener("scroll",null)}));const Qe=e=>{let t=null,l=null;for(let o of Ge)1==o.sel?t=o:null==l&&null==o.table&&(l=o);t.table&&ut(t),t.table=e,null!=l&&(l.sel=!0,t.sel=!1),e.select=1};function Xe(e){if(1==e){document.getElementById("scroll1").scrollLeft-=60}else{document.getElementById("scroll1").scrollLeft+=69}}function Ye(e){if(1==e){document.getElementById("scroll2").scrollLeft-=60}else{document.getElementById("scroll2").scrollLeft+=69}}function et(){const e=76/23;let t=E.customSetting.delivery.pallet;const l=t.reduce(((e,t)=>e+parseInt(t)),0);if(B.isMars)t=[20,20,20,15];else if(0==B.sn.indexOf("818")||0==B.sn.indexOf("2")||0==B.sn.indexOf("819")){const e=[];E.customSetting.delivery.pallet.map(((t,l)=>{e.push(t)})),t=e}else l>76&&(t=[20,20,20,0]);let o=0,s=0,i=[].concat(Ge);Ge.splice(0,Ge.length),w=[];for(let a=0;a<t.length;a++)s+=o+t[a],o=s-t[a],t[a]>0&&(w.push(parseInt(s/e+"")-parseInt(o/e+"")),Ge.push(qe[w.length-1]));if(i.length!=Ge.length){for(let e of i)ut(e);dt(Ge[0])}}function tt(){if(ee.boardlist&&ee.boardlist.length&&ee.boardlist[ee.swipertab]&&ee.boardlist[ee.swipertab].length){let e=1==Z.value?ee.floorlist:ee.floorlist2,t=1==Z.value?ee.boardlist[ee.swipertab][0].floorName?ee.boardlist[ee.swipertab][0].floorName:ee.boardlist[ee.swipertab][0].floor:ee.boardlist2[ee.swipertab2][0].floorName?ee.boardlist2[ee.swipertab2][0].floorName:ee.boardlist2[ee.swipertab2][0].floor;for(let l in e)e[l].name==t?(e[l].sel=!0,vt(Number(l))):e[l].sel=!1}}function lt(e){ee.swipertab=e.activeIndex,tt()}function ot(e){ee.swipertab2=e.activeIndex,tt()}function st(e){$e=e}function it(e){ze=e}function at(){1==Z.value?$e.slidePrev():ze.slidePrev()}function nt(){1==Z.value?$e.slideNext():ze.slideNext()}function rt(e){if(1==Z.value)for(let t in ee.boardlist){if((ee.boardlist[t][0].floorName?ee.boardlist[t][0].floorName:ee.boardlist[t][0].floor)==e){ee.swipertab=Number(t),$e.slideTo(Number(t));break}}else for(let t in ee.boardlist2){if((ee.boardlist2[t][0].floorName?ee.boardlist2[t][0].floorName:ee.boardlist2[t][0].floor)==e){ee.swipertab2=Number(t),ze.slideTo(Number(t));break}}Ze(),tt()}function dt(e){for(let t of Ge)t.sel=!1;e.sel=!0}function ct(e,t){let l=(1==Z.value?ee.boardlist:ee.boardlist2)[e][t],o=null,s=null;for(let i of Ge)1==i.sel?o=i:null==s&&null==i.table&&(s=i);o.table&&ut(o),o.table=l,null!=s&&(s.sel=!0,o.sel=!1),l.select=1}function ut(e){let t=e.table;e.table=null,e.taskStatus=0;let l=!1;for(let o of Ge)o.table==t&&(l=!0);0==l&&(t.select=0)}function pt(e){let t=w.concat(),l=e.concat(),o=W.getInstance().getRobotSn();if(o&&o.startsWith("2")){let o=t.length-1,s=[];for(let t of e){let e=o-t;s.push(e)}l=s.concat(),t=t.reverse()}let s=[];for(let i of l){let e=0;for(let l=0;l<i;l++)e+=parseInt(t[l]);s.push({index:e,num:t[i]})}return s}function ft(e){let t=null,l=q[2];l&&l[e+""]&&(t=l[e+""]);let o={mode:A,audioId:M.audioIdset("3111002"),num:1,volume:E.customSetting.sound.switchon?E.customSetting.sound.voiceVolume:0,interval:-1,duration:-1,forcePlay:!0};return t&&(o.url=G(t.fileUrl),t.fileUrl&&(o.audioId=""),o.interval=t.ruleInterval,1==t.ruleType?o.num=t.ruleCount:2==t.ruleType&&(o.duration=t.ruleDuration)),o}function mt(){let e=[],t={};for(let s=0;s<Ge.length;s++){let l=Ge[s].table;if(l){let o=!1;for(let t of e)t.id==l.id&&(o=!0);null==t[l.id+""]?t[l.id+""]=[s]:t[l.id+""].push(s),0==o&&e.push(l)}}let l=[];function o(o,s=!0){const i={x:o.coordinate[0],y:o.coordinate[1],yaw:o.yaw,areaId:o.areaId,dockingRadius:o.properties&&o.properties.dockingRadius?o.properties.dockingRadius:"1",ext:{name:o.name,id:o.id,idx:s?t[o.id+""]:e.length,len:Ge.length},stepActs:[{type:O.PlayAudio,data:ft(o.id)},{type:O.OpenLight,data:{mode:1,color:E.isFiveInOne?1:-1,indexs:s?pt(t[o.id+""]):[]}},{type:F(20),data:{}},{type:O.StopAudio,data:{mode:A}},{type:O.PlayAudio,data:{mode:E.customSetting.basic.returnStandbyId?A:-1,audioId:M.audioIdset("3111007"),num:1,volume:E.customSetting.sound.switchon?E.customSetting.sound.voiceVolume:0,interval:-1,duration:-1,forcePlay:!0}},{type:O.OpenLight,data:{mode:A,color:4}}]};(!B.isMars||E.customSetting.delivery.openSmartswitch)&&B.isMars||E.isFiveInOne||!E.customSetting.otherSetting.lightStrip.lightStripSwitch||(i.stepActs.splice(1,1,{type:O.OpenLight,data:{mode:1,color:E.customSetting.otherSetting.lightStrip.arriveState.lightColor,feature:E.customSetting.otherSetting.lightStrip.arriveState.lightType}}),i.stepActs.splice(-1,1,{type:O.OpenLight,data:{mode:1,color:E.customSetting.otherSetting.lightStrip.taskState.lightColor,feature:E.customSetting.otherSetting.lightStrip.taskState.lightType}})),l.push(i)}for(let s=0;s<e.length;s++){o(e[s])}if(l.length>0){let e={};const t=localStorage.getItem("lineCallInfo");if(t&&E.customSetting.delivery.isLineCall){const l=JSON.parse(t).taskPt;if(l.length){const t=l[l.length-1];e={type:t.type,x:t.x,y:t.y,yaw:t.yaw,areaId:t.areaId,dockingRadius:t.stopRadius?t.stopRadius:"1",ext:{name:t.ext.name,id:t.ext.id},stepActs:[{type:O.OpenLight,data:{mode:1,color:E.customSetting.otherSetting.lightStrip.lightStripSwitch?E.customSetting.otherSetting.lightStrip.taskState.lightColor:-1,feature:E.customSetting.otherSetting.lightStrip.taskState.lightType}}]}}}let o={ext:{name:"起点"},stepActs:[{type:O.OpenLight,data:{mode:1,color:E.customSetting.otherSetting.lightStrip.lightStripSwitch?E.customSetting.otherSetting.lightStrip.taskState.lightColor:-1,feature:E.customSetting.otherSetting.lightStrip.taskState.lightType}},{type:O.PlayAudio,data:{mode:A,audioId:M.audioIdset("3111012"),num:1,volume:E.customSetting.sound.switchon?E.customSetting.sound.voiceVolume:0,interval:-1,duration:-1,channel:1,forcePlay:!0}},{type:O.SetSpeed,data:{speed:E.customSetting.delivery.runSpeed/100}}]},s={name:"快捷任务"+(new Date).getTime(),runNum:1,taskType:R(),runMode:+(E.customSetting.basic.runMode||1),routeMode:2,runType:20,curPt:o,pts:l,backPt:e,ignorePublicSite:!0};D.getInstance().startTask(s),W.getInstance().setSmoothLevel(localStorage.getItem("deliveryType"))}else $.show(L("index.wxzzd"))}function vt(e){var t=document.getElementById("id"+Number(e));t&&t.scrollIntoView({block:"center",inline:"center",behavior:"auto"})}return et(),n((()=>H.value),((e,t)=>{for(let l of Ge)ut(l)})),n((()=>V.value),((e,t)=>{j((()=>{rt(e)}))}),{immediate:!0}),n((()=>K.value),((e,t)=>{2==E.businessScene&&(Z.value=1)})),k({pallet:Ge,setpallent:et,delectcurrent:ut,userstore:E,revise:dt,initscroll:function(){let e=1==Z.value?ee.floorlist:ee.floorlist2;for(let t in e)e[t].sel&&vt(Number(t))}}),(e,t)=>(_(),r("div",te,[d("div",le,[d("div",oe,[se,d("div",null,c(e.$t("index.tpc")),1),ie]),(_(!0),r(u,null,p(Ge,((t,l)=>(_(),r("div",{class:v(0==l?"tray_layer":"tray_layer layer_top"),key:l,onClick:e=>dt(t)},[d("div",ne,"L"+c(l+1),1),t.table?(_(),r("div",re,[d("div",{class:v(["font3",t.sel?"warning-color":""]),style:x(t.sel?"font-size:18px":"")},c(t.table.name),7),d("img",{src:C,onClick:I((e=>ut(t)),["stop"])},null,8,de)])):h("",!0),!t.table&&t.sel?(_(),r("div",ce,"("+c(e.$t("index.qxzdw"))+")",1)):h("",!0),t.table||t.sel?h("",!0):(_(),r("div",ue,c(e.$t("index.dxdw")),1)),pe],10,ae)))),128))]),d("div",null,[d("div",fe,[f(d("div",me,[d("div",ve,[f(d("div",{class:v(g(ee).floorlist.length>0?"floor_content":"floor_content2")},[g(ee).floorlist.length>5?(_(),r("div",{key:0,class:v(Fe.value?"floorleft_per1":"floorleft_per2"),onClick:t[0]||(t[0]=e=>Xe(1))},ge,2)):h("",!0),g(ee).floorlist.length>0?(_(),r("div",he,[(_(!0),r(u,null,p(g(ee).floorlist,((e,t)=>(_(),r("div",{id:"id"+t,class:v(e.sel?"one_floor":"nosel_floor"),onClick:t=>rt(e.name),key:t},c(e.name),11,be)))),128))])):h("",!0),g(ee).floorlist.length>5?(_(),r("div",{key:2,class:v(Ve.value?"floorright_per1":"floorright_per2"),onClick:t[1]||(t[1]=e=>Xe(2))},ye,2)):h("",!0)],2),[[m,1==Z.value]]),f(d("div",{class:v(g(ee).floorlist2.length>0?"floor_content":"floor_content2")},[g(ee).floorlist2.length>5?(_(),r("div",{key:0,class:v(Je.value?"floorleft_per1":"floorleft_per2"),onClick:t[2]||(t[2]=e=>Ye(1))},Se,2)):h("",!0),d("div",ke,[(_(!0),r(u,null,p(g(ee).floorlist2,((e,t)=>(_(),r("div",{id:"id"+t,class:v(e.sel?"one_floor":"nosel_floor"),onClick:t=>rt(e.name),key:t},c(e.name),11,we)))),128))]),g(ee).floorlist2.length>5?(_(),r("div",{key:1,class:v(Ue.value?"floorright_per1":"floorright_per2"),onClick:t[3]||(t[3]=e=>Ye(2))},_e,2)):h("",!0)],2),[[m,2==Z.value]])]),d("div",xe,[d("div",Ie,[1==Z.value&&g(ee).floorlist.length>0?(_(),r("span",{key:0,onClick:at,class:v([0==g(ee).swipertab?"disable-pre":"active-pre","swiper-button-prev"])},null,2)):h("",!0),2==Z.value&&g(ee).floorlist2.length>0?(_(),r("span",{key:1,onClick:at,class:v([0==g(ee).swipertab2?"disable-pre":"active-pre","swiper-button-prev"])},null,2)):h("",!0)]),1==Z.value?(_(),r("div",je,[d("div",Ce,[b(g(N),{style:{width:"100%",height:"100%"},initialSlide:g(ee).swipertab,"slides-per-view":1,"space-between":50,onSwiper:st,onSlideChange:lt},{default:y((()=>[(_(!0),r(u,null,p(g(ee).boardlist,((e,t)=>(_(),S(g(P),{key:t,class:"slideone"},{default:y((()=>[(_(!0),r(u,null,p(e,((e,l)=>(_(),r("div",{key:l,class:v(1==e.select?"one_Point font1":"one_Point2 font1"),style:x(e.name?"":"display:none"),onClick:e=>ct(t,l)},[d("span",null,c(e.name),1)],14,Le)))),128))])),_:2},1024)))),128))])),_:1},8,["initialSlide"])]),d("div",Ne,[d("div",Pe,[(_(!0),r(u,null,p(g(ee).boardlist,((e,t)=>(_(),r("div",{key:t,class:v(t==g(ee).swipertab?"one_dot":"one_dot2")},null,2)))),128))])])])):h("",!0),2==Z.value?(_(),r("div",Te,[d("div",Ee,[b(g(N),{style:{width:"100%",height:"100%"},initialSlide:g(ee).swipertab2,"slides-per-view":1,"space-between":50,onSwiper:it,onSlideChange:ot},{default:y((()=>[(_(!0),r(u,null,p(g(ee).boardlist2,((e,t)=>(_(),S(g(P),{key:t,class:"slideone"},{default:y((()=>[(_(!0),r(u,null,p(e,((e,l)=>(_(),r("div",{key:l,class:v(1==e.select?"one_Point font1":"one_Point2 font1"),style:x(e.name?"":"display:none"),onClick:e=>ct(t,l)},[d("span",null,c(e.name),1)],14,Be)))),128))])),_:2},1024)))),128))])),_:1},8,["initialSlide"])]),d("div",Oe,[d("div",Ae,[(_(!0),r(u,null,p(g(ee).boardlist2,((e,t)=>(_(),r("div",{class:v(t==g(ee).swipertab2?"one_dot":"one_dot2")},null,2)))),256))])])])):h("",!0),d("div",Me,[1==Z.value&&g(ee).floorlist.length>0?(_(),r("span",{key:0,onClick:nt,class:v([g(ee).swipertab==g(ee).boardlist.length-1?"disable-pre":"active-pre","swiper-button-next"])},null,2)):h("",!0),2==Z.value&&g(ee).floorlist2.length>0?(_(),r("span",{key:1,onClick:nt,class:v([g(ee).swipertab2==g(ee).boardlist2.length-1?"disable-pre":"active-pre","swiper-button-next"])},null,2)):h("",!0)])])],512),[[m,!He.value]]),He.value?(_(),S(Q,{key:Ke.value,isBookmarkType:He.value,onSelectPosition:Qe},null,8,["isBookmarkType"])):h("",!0),d("div",Re,[b(X),d("div",{class:"index_right_bottom font1",onClick:mt},[g(E).isModify?(_(),r("span",De,c(e.$t("index.xgrw")),1)):(_(),r("span",We,c(e.$t("index.ljcf")),1))])])])])]))}}),[["__scopeId","data-v-2996d2f5"]]);export{ze as default};
