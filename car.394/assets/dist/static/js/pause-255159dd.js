import{_ as e}from"./icon-home-15bd5876.js";import{ai as s,y as t,aX as a,a$ as l,X as o,d as n,R as i,a as c,aR as r,ay as p,b0 as u,T as d,b1 as m,aL as h,_ as v}from"./index-d6250428.js";import{s as f}from"./pinia-118dd6fd.js";import{u as g}from"./vue-router-fe18c2fe.js";import{H as x}from"./hotelDialog-e4dd1514.js";import{C as b,r as k,aZ as j,a1 as y,p as w,c as T,a as _,T as I,M as $,u as C,L as S,a3 as D,K as M,b3 as z,b2 as B,o as G,w as L}from"./@vue-73fba911.js";import"./vue-i18n-5829ac11.js";import"./@intlify-352b7567.js";import"./element-plus-5a8aeb67.js";import"./dayjs-4c03de08.js";import"./@autoxing-9bbbdd2d.js";import"./axios-2c1be958.js";import"./websocket-963e06e0.js";import"./es5-ext-689fde2c.js";import"./lodash-es-fa68f30b.js";import"./@vueuse-171ed302.js";import"./@element-plus-c72353dc.js";import"./@ctrl-ee9bdfd4.js";import"./async-validator-efc2d198.js";import"./@popperjs-892fd7f5.js";import"./escape-html-4bbaf1e1.js";import"./normalize-wheel-es-da779ce4.js";import"./vue3-loading-overlay-a6191c09.js";import"./vue-slider-component-7621b196.js";import"./vue-6ec50eb9.js";import"./mitt-dab1f1cb.js";import"./swiper-276df855.js";import"./ssr-window-792d0f84.js";import"./dom7-250848e3.js";import"./amfe-flexible-1f7bb7f4.js";const q=e=>(z("data-v-607dc1ac"),e=e(),B(),e),H={class:"pause-info"},E={class:"top-box"},R={class:"top-left"},F=q((()=>_("img",{src:e,alt:""},null,-1))),N={class:"times"},P={class:"tabs-box"},X={class:"tab-content"},J={key:0,class:"tab-box"},K={class:"task_span"},O={class:"task_span span4"},Y={class:"task_span"},Z=["onClick"],A={key:0,class:"empty-box"},Q={key:1,class:"tab-box"},U={class:"task_span"},V={class:"task_span span4"},W={class:"task_span"},ee={class:"task_span"},se=["onClick"],te={key:0,class:"empty-box"},ae={key:0,class:"footer-box"},le={key:1,class:"ocenter abnormaltank"},oe={class:"erroinner"},ne=[q((()=>_("img",{src:r,alt:""},null,-1)))],ie={class:"title-box"},ce={class:"info-box"},re=["onClick"],pe=v(b({__name:"pause",setup(e){const r=s();t();const v=a(),{taskList:b,leaveTaskList:z}=f(v);let B=k("1");const q=k(!1),pe=k(60),ue=g();let de=null;const me=k(!1),he=[];j((()=>{console.log(n.currentRoute.value.fullPath),function(){let e=L((()=>v.isBoorError),((e,s,t)=>{"error"===e&&n.push("/hotel/saveBox")}));he.push(e)}(),p.on("doorStatus",(e=>{console.log(JSON.stringify(e)+55555555555),2===e.type?"2"==B.value?x.show({data:{errType:5},type:"success",sure:()=>{l.getInstance().closeBox(1).then((e=>{c.showTimes()}))},cancel:()=>{ve(),x.close()}}):x.show({data:{errType:2},type:"success",sure:()=>{c.showTimes(),l.getInstance().closeBox(1).then((e=>{}))}}):3===e.type&&("2"==B.value?(x.close(),ve()):(ke(de.ext.times),x.close(),ve()))})),"/hotel/pause"===ue.path&&(me.value=!0,h.show({downTimes:30,isScreenLock:!1}).then((e=>{me.value=!1,e?(pe.value=60,ve()):Te()}))),B.value=ue.query.tabs||"1",pe.value=60,ve()})),y((()=>{!function(){for(;he.length;)he.pop()()}(),p.off("doorStatus"),x.isShowStatus()&&x.close(),o.getInstance().removeTime("pause")}));const ve=()=>{o.getInstance().startTime("pause",1e3,pe.value,(e=>(pe.value=e,0===e&&Te(),!me.value&&!u.isShowStatus())))},fe=w((()=>e=>{if(e)return e.replace(/^(\d{3})\d{4}(\d{4})$/,"$1****$2")})),ge=w((()=>e=>{let s=new Date(e);return s.getFullYear(),(s.getMonth()+1<10?"0"+(s.getMonth()+1):s.getMonth()+1)+"-"+((s.getDate()<10?"0"+s.getDate():s.getDate())+" ")+((s.getHours()<10?"0"+s.getHours():s.getHours())+":")+((s.getMinutes()<10?"0"+s.getMinutes():s.getMinutes())+":")+(s.getSeconds()<10?"0"+s.getSeconds():s.getSeconds())}));function xe(){B.value="1"}function be(){B.value="2"}function ke(e){let s=null;console.log(r.list,1111111);for(let t=0;t<r.list.length;t++)r.list[t].times==e&&(s=r.list[t]);s&&(s.status=3,s.preGet=!0,d.getInstance().finishTargetName(s.name),s.idx&&m(!0,s.idx.join(",")))}function je(){q.value=!0,we.value=!1,z.value.forEach((e=>{e.sel&&(e.sel=!1)}))}function ye(){let e=[];z.value.forEach((s=>{s.sel&&e.push(s)})),e.length&&(l.getInstance().restartStaytask(e),q.value=!1)}let we=k(!1);function Te(){if(o.getInstance().removeTime("pause"),"/hotel/retention"===ue.path)n.push("/hotel/homes");else if(r.list&&!r.list.length)n.push("/running");else{let e=i.getInstance(),s=[];for(let t=0;t<r.list.length;t++)1==r.list[t].preGet&&s.push({index:t,isPass:!0});console.log(r.runType,"===================="),s.length>0&&[20].includes(r.runType)?(c.show(),e.updateTask(s).then((s=>e.executeTask())).then((e=>{c.close();for(let s=0;s<r.list.length;s++)1==r.list[s].preGet&&(r.list[s].preGet=!1)})).catch((e=>{c.close()}))):(c.show(),e.resumeTask().then((()=>{c.close()})).catch((e=>{c.close()})))}}return(e,s)=>(G(),T("div",H,[_("div",E,[_("div",R,[_("p",{onClick:Te},[F,_("span",null,I(e.$t("hotel.fh")),1),_("span",N,"("+I(pe.value)+"s)",1)])])]),_("div",P,[_("span",{class:$("1"===C(B)?"active":""),onClick:xe},I(e.$t("hotel.dqrw")),3),_("span",{class:$("2"===C(B)?"active":""),onClick:be},I(e.$t("hotel.zld")),3)]),_("div",X,["1"===C(B)?(G(),T("div",J,[(G(!0),T(S,null,D(C(b),((s,t)=>(G(),T("div",{class:"task_list",key:t},[_("span",K,I(t+1)+".",1),_("span",O,I(s.ext.name),1),_("span",Y,I(C(fe)(s.ext.phone)),1),_("div",{class:"take_button",onClick:e=>function(e,s){de=e,o.getInstance().stopTime("pause"),x.show({data:{errType:4},type:"success",sure:()=>{if(x.close(),c.showTimes(),2===v.hotelTaskType)return ke(e.ext.times),l.getInstance().cancelFollowTask(e.ext.times),ve(),void c.close();l.getInstance().openBoxGet({name:e.ext.name,id:e.ext.id,phone:e.ext.phone,times:e.ext.times,selectData:e.ext.selectData})},cancel:()=>{ve(),x.close()}})}(s)},I(e.$t("hotel.qxrw")),9,Z)])))),128)),C(b).length?M("",!0):(G(),T("div",A,I(e.$t("hotel.zwrw")),1))])):M("",!0),"2"===C(B)?(G(),T("div",Q,[(G(!0),T(S,null,D(C(z),((s,t)=>(G(),T("div",{class:"task_list",key:t},[_("span",U,I(t+1)+".",1),_("span",V,I(s.ext.name),1),_("span",W,I(s.address),1),_("span",ee,I(C(ge)(s.ext.times)),1),_("div",{class:"take_button",onClick:e=>function(e,s){l.getInstance().openBoxGet({name:e.ext.name,id:e.ext.id,phone:e.ext.phone,times:e.ext.times,selectData:e.ext.selectData},"leaveTaskList").then((()=>{c.showTimes(),o.getInstance().stopTime("pause")}))}(s)},I(e.$t("hotel.ljqc")),9,se)])))),128)),C(z).length?M("",!0):(G(),T("div",te,I(e.$t("hotel.zwzld")),1))])):M("",!0)]),"2"===C(B)&&C(z).length?(G(),T("div",ae,[_("div",{class:"footer-btn btn",onClick:je},I(e.$t("hotel.cxpsdd")),1)])):M("",!0),q.value?(G(),T("div",le,[_("div",oe,[_("div",{class:"close-box",onClick:s[0]||(s[0]=e=>q.value=!1)},ne),_("div",ie,[_("span",null,I(e.$t("hotel.qxzxypsdfw")),1)]),_("div",ce,[(G(!0),T(S,null,D(C(z),((e,s)=>(G(),T("div",{class:$(e.sel?"active dialog_list":"dialog_list"),key:s,onClick:s=>function(e,s){we.value=!1,e.sel?e.sel=!1:e.sel=!0,z.value.map((e=>{e.sel&&(we.value=!0)}))}(e)},[_("span",null,I(e.ext.name),1)],10,re)))),128))]),_("div",{class:$(["",C(we)?"sure-btn btn":"disabled"]),onClick:ye},I(e.$t("hotel.cxps")),3)])])):M("",!0)]))}}),[["__scopeId","data-v-607dc1ac"]]);export{pe as default};
