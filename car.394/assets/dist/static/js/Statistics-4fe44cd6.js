import{n as e,h as t,i as a,o as s,p as l,s as n}from"./element-plus-5a8aeb67.js";import{y as o,Q as i,bC as r,bD as p,g as d,R as u,_ as c}from"./index-d6250428.js";import{C as g,W as m,p as b,aZ as f,c as w,a as v,T as j,R as h,P as y,o as T,L as k,a3 as $,O as x,u as D}from"./@vue-73fba911.js";import"./dayjs-4c03de08.js";import"./@autoxing-9bbbdd2d.js";import"./axios-2c1be958.js";import"./websocket-963e06e0.js";import"./es5-ext-689fde2c.js";import"./lodash-es-fa68f30b.js";import"./@vueuse-171ed302.js";import"./@element-plus-c72353dc.js";import"./@ctrl-ee9bdfd4.js";import"./async-validator-efc2d198.js";import"./@popperjs-892fd7f5.js";import"./escape-html-4bbaf1e1.js";import"./normalize-wheel-es-da779ce4.js";import"./vue-router-fe18c2fe.js";import"./vue-i18n-5829ac11.js";import"./@intlify-352b7567.js";import"./pinia-118dd6fd.js";import"./vue3-loading-overlay-a6191c09.js";import"./vue-slider-component-7621b196.js";import"./vue-6ec50eb9.js";import"./mitt-dab1f1cb.js";import"./swiper-276df855.js";import"./ssr-window-792d0f84.js";import"./dom7-250848e3.js";import"./amfe-flexible-1f7bb7f4.js";const S={class:"time-setting"},I={class:"time-btn-list"},_={class:"btn-list"},z={class:"btn"},O={class:"item-value"},C={class:"btn"},R={class:"item-value"},V={class:"btn"},M={class:"item-value"},L={class:"time-list"},P={class:"date-time-picker"},U=c(g({__name:"Statistics",setup(c){const g=o(),U=m({list:[],total:0,currentPage:1,taskOverviewData:{taskCount:0,taskDuration:0,taskMileage:0},noDataText:i.global.t("setting.zwsj")}),q=m({pickerOptions:{disabledDate:e=>e.getTime()>Date.now()},dateRange:[],sourceType:"",runType:"",runTypeList:r.filter((e=>e.show.includes(g.robotType))),sourceTypeList:p}),F=b((()=>e=>{const t=r.find((t=>t.id===e.runType));return t?t.name:""})),G=b((()=>e=>{const t=p.find((t=>t.id===e.sourceType));return t?t.name:""}));function H(){U.noDataText=i.global.t("setting.qqz");const e={deviceId:d.sn,businessId:d.businessId,page:U.currentPage,pageSize:10};let t=null,a=null;q.dateRange&&q.dateRange.length&&(t=q.dateRange[0],a=q.dateRange[1]),t&&(e.startTime=Math.floor(t.getTime()/1e3)),a&&(e.endTime=Math.floor(a.getTime()/1e3)),""!==q.runType&&(e.runType=q.runType),""!==q.sourceType&&(e.sourceType=q.sourceType),u.getInstance().offlineGetTasksStatis(e).then((e=>{console.log(e,"=================="),e&&200===e.status?(U.list=e.data.list||[],U.total=e.data.total||0,U.noDataText=i.global.t("setting.zwsj")):(U.total=0,U.noDataText=i.global.t("setting.zwsj"))}))}function Q(e){U.currentPage=e,H()}function W(e){if(!e)return"";const t=new Date(e);return`${t.getFullYear()}${(t.getMonth()+1).toString().padStart(2,"0")}${t.getDate().toString().padStart(2,"0")} ${t.getHours().toString().padStart(2,"0")}:${t.getMinutes().toString().padStart(2,"0")}:${t.getSeconds().toString().padStart(2,"0")}`}function Y(e){if(e<60)return parseInt(e)+i.global.t("setting.miao");if(e>=60&&e<3600){let t=parseInt(e/60),a=parseInt(e-60*t),s=t+i.global.t("setting.fenzhong");return a>0&&(s+=a+i.global.t("setting.miao")),s}if(e>3600){let t=parseInt(e/60/60),a=parseInt((e-3600*t)/60),s=t+i.global.t("setting.xiaoshi");return a>0&&(s+=a+i.global.t("setting.fenzhong")),s}}return f((()=>{!function(){const e={deviceId:d.sn,businessId:d.businessId};u.getInstance().offlineGetOverviewStatis(e).then((e=>{console.log(e),200===e.status&&e.data&&(U.taskOverviewData=e.data.taskOverviewData)}))}(),H()})),(o,r)=>{const p=e,d=t,u=a,c=s,g=l,m=n;return T(),w("div",S,[v("div",I,[v("div",_,[v("div",z,[v("span",null,j(o.$t("setting.rwsl")),1),v("span",O,j(U.taskOverviewData.taskCount),1)]),v("div",C,[v("span",null,j(o.$t("setting.rwsc")),1),v("span",R,j(U.taskOverviewData.taskDuration),1)]),v("div",V,[v("span",null,j(o.$t("setting.rwlc")),1),v("span",M,j(U.taskOverviewData.taskMileage),1)])])]),v("div",L,[v("div",P,[h(p,{class:"date-picker",editable:!1,teleported:!1,modelValue:q.dateRange,"onUpdate:modelValue":r[0]||(r[0]=e=>q.dateRange=e),"disabled-date":q.pickerOptions.disabledDate,onChange:H,type:"datetimerange","range-separator":"-","start-placeholder":o.$t("setting.kssj"),"end-placeholder":o.$t("setting.jssj")},null,8,["modelValue","disabled-date","start-placeholder","end-placeholder"]),h(u,{class:"select-box",modelValue:q.runType,"onUpdate:modelValue":r[1]||(r[1]=e=>q.runType=e),onChange:H,placeholder:o.$t("setting.rwlx"),size:"large",teleported:!1,clearable:""},{default:y((()=>[(T(!0),w(k,null,$(q.runTypeList,(e=>(T(),x(d,{key:e.id,label:o.$t(e.name),value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue","placeholder"]),h(u,{class:"select-box",modelValue:q.sourceType,"onUpdate:modelValue":r[2]||(r[2]=e=>q.sourceType=e),onChange:H,placeholder:o.$t("setting.rwly"),size:"large",teleported:!1,clearable:""},{default:y((()=>[(T(!0),w(k,null,$(q.sourceTypeList,(e=>(T(),x(d,{key:e.id,label:o.$t(e.name),value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue","placeholder"])]),h(g,{data:U.list,"empty-text":U.noDataText,style:{width:"100%"}},{default:y((()=>[h(c,{type:"index",align:"center",width:"50"}),h(c,{prop:"startTime",align:"center",width:"190",label:o.$t("setting.kssj"),"show-overflow-tooltip":""},{default:y((e=>[v("span",null,j(W(e.row.startTime)),1)])),_:1},8,["label"]),h(c,{prop:"startTime",align:"center",width:"190",label:o.$t("setting.jssj"),"show-overflow-tooltip":""},{default:y((e=>[v("span",null,j(W(e.row.endTime)),1)])),_:1},8,["label"]),h(c,{prop:"name",align:"center",label:o.$t("setting.rwlc"),"show-overflow-tooltip":""},{default:y((e=>{return[v("span",null,j((t=e.row.mileage,t?(t=t.toFixed(2))>1e3?t/1e3+i.global.t("unit.taskmileagekm"):t+i.global.t("unit.taskmileage"):0+i.global.t("unit.taskmileage"))),1)];var t})),_:1},8,["label"]),h(c,{prop:"name",align:"center",label:o.$t("setting.rwsc"),"show-overflow-tooltip":""},{default:y((e=>[v("span",null,j(Y(e.row.duration)),1)])),_:1},8,["label"]),h(c,{prop:"name",align:"center",label:o.$t("setting.rwly"),"show-overflow-tooltip":""},{default:y((e=>[v("span",null,j(D(F)(e.row)?o.$t(D(F)(e.row)):"--"),1)])),_:1},8,["label"]),h(c,{prop:"type",align:"center",label:o.$t("setting.rwlx"),"show-overflow-tooltip":""},{default:y((e=>[v("span",null,j(D(G)(e.row)?o.$t(D(G)(e.row)):"--"),1)])),_:1},8,["label"])])),_:1},8,["data","empty-text"]),h(m,{"page-size":10,onCurrentChange:Q,"pager-count":9,layout:"prev, pager, next",total:U.total},null,8,["total"])])])}}}),[["__scopeId","data-v-30ea49c9"]]);export{U as default};
