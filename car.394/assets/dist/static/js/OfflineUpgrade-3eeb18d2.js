import{f as e}from"./element-plus-5a8aeb67.js";import{R as s}from"./ResourceSelect-46070d7b.js";import{C as a,r as t,W as o,aZ as n,c as i,a as l,T as p,R as r,P as c,K as d,a4 as m,L as u,a3 as f,u as v,O as b,o as g}from"./@vue-73fba911.js";import{av as j,o as h,g as y,ay as k,W as x,_ as $}from"./index-d6250428.js";import"./dayjs-4c03de08.js";import"./@autoxing-9bbbdd2d.js";import"./axios-2c1be958.js";import"./websocket-963e06e0.js";import"./es5-ext-689fde2c.js";import"./lodash-es-fa68f30b.js";import"./@vueuse-171ed302.js";import"./@element-plus-c72353dc.js";import"./@ctrl-ee9bdfd4.js";import"./async-validator-efc2d198.js";import"./@popperjs-892fd7f5.js";import"./escape-html-4bbaf1e1.js";import"./normalize-wheel-es-da779ce4.js";import"./adResource-0d6f2b77.js";import"./index-f7b9e1fb.js";import"./vue-i18n-5829ac11.js";import"./@intlify-352b7567.js";import"./vue-slider-component-7621b196.js";import"./vue-6ec50eb9.js";import"./qrcode.vue-ab61320f.js";import"./vue-router-fe18c2fe.js";import"./pinia-118dd6fd.js";import"./vue3-loading-overlay-a6191c09.js";import"./mitt-dab1f1cb.js";import"./swiper-276df855.js";import"./ssr-window-792d0f84.js";import"./dom7-250848e3.js";import"./amfe-flexible-1f7bb7f4.js";const w={class:"developer-box"},T={class:"top-box"},z={class:"font-24"},q={class:"title font-24"},C=m(),N={class:"font-20"},S={class:"content-box"},R={class:"text-box"},_={class:"tip-info"},I={class:"version-info"},O={class:"info-box"},A={key:0},L={key:1},U={key:2},J={key:3},M={key:4},P={key:0,class:"view"},W={key:0,class:"message-box"},H={key:1,class:"ocenter abnormaltank"},D={class:"erroinner"},E={class:"update-info"},F=["innerHTML"],K=$(a({__name:"OfflineUpgrade",setup(a){t("");const $=t(!1),K=t(null),Z=t({}),B=t(!1);let G=o({path:"",name:"",fileName:""});const Q=o({hw:{},soft:{},mapping:{},UC:{},car:{}});function V(e){console.log(e,"================"),e&&X(e)}function X(e){G.name=e.fileName||e.name,G.fileName=(e.fileName||e.name).replace(/.zip$/,""),G.path=e.path;const s={data:{path:e.path,name:G.fileName+".json"},uniqueId:(new Date).getTime(),reqType:"onReadFileContent"};console.log(e,s),x.getInstance().onopen(s).then((e=>{B.value=!0;let s=JSON.parse(e);(s.data&&s.data.config||[]).forEach(((e,s)=>{Q[e.source]=e}))}))}n((()=>{k.on("onWebsocketMessage",(e=>{const s=JSON.parse(e);"uploadStatus"===s.reqType&&(B.value=!0,X(s.data))}))}));const Y=t(""),ee=()=>{$.value=!0;const e=j.getInstance().getRobotTypeInfo();console.log(e),h.getAppPackageLog({...e,fileName:G.fileName}).then((e=>{e&&(Y.value=e)}))};let se=t(!1);function ae(){B.value?h.installApp({filePath:G.path,id:y.sn}).then((e=>{(0===e.code||1===e.code)&&(K.value=setTimeout(oe,1e3))})).catch((e=>{console.log("===installAppCatch"+JSON.stringify(e))})):se.value=!0}function te(){se.value=!1}const oe=()=>{h.installAppState().then((e=>{e.data&&(Z.value=e.data,0===e.data.state?K.value=setTimeout(oe,1e3):(1===e.data.state||-1===e.data.state)&&clearTimeout(K.value))})).catch((e=>{clearTimeout(K.value)}))};return(a,t)=>{const o=e;return g(),i("div",w,[l("div",T,[l("p",z,[l("span",q,p(a.$t("setting.lxsj")),1),C,l("span",N,p(a.$t("setting.scazbhsj")),1)])]),l("div",S,[l("div",R,[l("div",_,[l("p",null,p(a.$t("setting.qcjqrglptxzazhzscaz")),1),l("p",null,p(a.$t("setting.qzyazcghhcqjqrswj")),1)]),r(o,{class:"btn upload-btn",type:"primary",onClick:ae},{default:c((()=>[m(p(B.value?a.$t("setting.az"):a.$t("setting.sc")),1)])),_:1})]),l("div",I,[l("div",O,[Q.hw.version?(g(),i("span",A,p(a.$t("setting.dpbb"))+":"+p(Q.hw.version),1)):d("",!0),Q.soft.version?(g(),i("span",L,p(a.$t("setting.python"))+":"+p(Q.soft.version),1)):d("",!0),Q.UC.version?(g(),i("span",U,p(a.$t("setting.swjfubb"))+":"+p(Q.UC.version),1)):d("",!0),Q.car.version?(g(),i("span",J,p(a.$t("setting.appbb"))+":"+p(Q.car.version),1)):d("",!0),Q.mapping.version?(g(),i("span",M,p(a.$t("setting.bbgxnr"))+":"+p(Q.mapping.version),1)):d("",!0)]),B.value?(g(),i("p",P,[l("span",{class:"view",onClick:ee},p(a.$t("setting.ck")),1),m(p(a.$t("setting.bbgxnr")),1)])):d("",!0)]),Z.value.progress?(g(),i("div",W,[l("span",null,p(a.$t("azjd"))+": "+p(Z.value.progress),1),(g(!0),i(u,null,f(Z.value.message,((e,s)=>(g(),i("span",{key:s},p(e),1)))),128))])):d("",!0)]),v(se)?(g(),b(s,{key:0,onCancel:te,onSure:V,startStep:3,resourceType:6})):d("",!0),$.value?(g(),i("div",H,[l("div",D,[l("div",E,[l("pre",{innerHTML:Y.value},null,8,F)]),l("div",{class:"enter1 btn",onClick:t[0]||(t[0]=e=>{$.value=!1})},p(a.$t("abnormal.qd")),1)])])):d("",!0)])}}}),[["__scopeId","data-v-7003f750"]]);export{K as default};
