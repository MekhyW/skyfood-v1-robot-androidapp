import{ai as e,y as a,a as t,R as r,T as s,L as o,_ as n}from"./index-d6250428.js";import{s as i}from"./pinia-118dd6fd.js";import{C as c,W as d,aZ as l,o as u,c as g,a as p,K as m}from"./@vue-73fba911.js";const f={key:0,class:"iframe"},y=["src"],I=n(c({__name:"iframePage",props:{pageType:{type:Number,default:1}},setup(n,{expose:c}){const I=n,v=e(),w=a();let{extData:T}=i(v);const h=d({show:!1,data:null,pageUrl:"",curResolve:null});function P(){window.addEventListener("message",(e=>{if(e.data){if(e.data&&e.data.orderId){const a=w.customSetting.otherSetting.customizedPage;e.data.url=e.data.url||a&&a.arrivePage}2===I.pageType?async function(){try{t.show(),v.isInterActing?(v.isPaused&&await r.getInstance().resumeTask(),await r.getInstance().continueTask(),s.getInstance().updateInterActStatus(!1)):await r.getInstance().resumeTask()}catch(e){o.logErrNew("TaskState","executeTask error",{error:e})}finally{t.close()}}():(h.show=!1,h.curResolve&&h.curResolve(e.data))}}))}function k(e={}){return console.log(e),new Promise(((a,t)=>{const r=w.customSetting.otherSetting.customizedPage;h.curResolve=a,r.switch&&1===I.pageType&&r.startPage||2===I.pageType&&r.arrivePage?(h.pageUrl=1===I.pageType&&r.startPage||2===I.pageType&&r.arrivePage,h.show=!0,h.data=e,h.pageUrl=1===I.pageType&&r.startPage||2===I.pageType&&T.value.url,setTimeout((()=>{const a=document.getElementById("myIframe"),t={name:e.name,id:e.id,orderId:e.orderId};a&&a.contentWindow.postMessage(t,"*")}),800)):a(null)}))}l((()=>{2===I.pageType&&(P(),h.pageUrl=function(e){if(!e)return"";return-1!==e.indexOf("?")?`${e}&orderId=${T.value.orderId}`:`${e}?orderId=${T.value.orderId}`}(T.value.url||""),k(T.value))})),P();const R=()=>{h.show=!1,h.curResolve&&h.curResolve(null)};return c({showIframe:k}),(e,a)=>h.show?(u(),g("div",f,[p("span",{class:"back-icon rotate180",onClick:R}),p("iframe",{id:"myIframe",src:h.pageUrl,frameborder:"0",allowfullscreen:"",style:{width:"100%",height:"100%",border:"none"}},null,8,y)])):m("",!0)}}),[["__scopeId","data-v-93f1aac3"]]);export{I};
