import{R as s,_ as e}from"./index-bc582883.js";import{C as t,r as o,W as a,aZ as l,a1 as n,w as i,c,R as d,u as r,a as p,a4 as u,T as v,K as m,b3 as h,b2 as b,o as f}from"./@vue-73fba911.js";import{y as x,aX as g,ai as j,a as k,a$ as y,R as _,d as $,ay as T,X as w,b0 as S,L as B,_ as I}from"./index-d6250428.js";import{P as L}from"./index-1077bd55.js";import{s as C}from"./pinia-118dd6fd.js";import"./vue-router-fe18c2fe.js";import"./vue-i18n-5829ac11.js";import"./@intlify-352b7567.js";import"./element-plus-5a8aeb67.js";import"./dayjs-4c03de08.js";import"./@autoxing-9bbbdd2d.js";import"./axios-2c1be958.js";import"./websocket-963e06e0.js";import"./es5-ext-689fde2c.js";import"./lodash-es-fa68f30b.js";import"./@vueuse-171ed302.js";import"./@element-plus-c72353dc.js";import"./@ctrl-ee9bdfd4.js";import"./async-validator-efc2d198.js";import"./@popperjs-892fd7f5.js";import"./escape-html-4bbaf1e1.js";import"./normalize-wheel-es-da779ce4.js";import"./vue3-loading-overlay-a6191c09.js";import"./vue-slider-component-7621b196.js";import"./vue-6ec50eb9.js";import"./mitt-dab1f1cb.js";import"./swiper-276df855.js";import"./ssr-window-792d0f84.js";import"./dom7-250848e3.js";import"./amfe-flexible-1f7bb7f4.js";import"./fastdeveryico1-eee468d9.js";const q=s=>(h("data-v-49588db2"),s=s(),b(),s),z={class:"arrive-box"},P={key:0,class:"position-info"},D={class:"info-contain"},E={class:"box_name"},R=q((()=>p("br",null,null,-1))),A={class:"box_tip"},F={class:"footer-box"},G={class:"bottom_div"},J={class:"down-times"},N={key:1,class:"position-info code-box"},O={class:"box_title"},W=q((()=>p("br",null,null,-1))),X={class:"left-right"},H={class:"footer-box"},K={class:"bottom_div"},M={class:"down-times"},Z={key:2,class:"position-info"},Q={class:"info-contain"},U={class:"box_name"},V=q((()=>p("br",null,null,-1))),Y={class:"box_tip_large"},ss={class:"box_tip"},es={class:"footer-box"},ts={class:"bottom_div"},os={class:"down-times"},as={key:3,class:"position-info"},ls={class:"info-contain"},ns={class:"box_tip"},is=q((()=>p("br",null,null,-1))),cs={class:"box_tip_large"},ds={class:"box_tip_large"},rs={class:"down-times"},ps={class:"box_tip"},us=q((()=>p("img",{src:e,alt:""},null,-1))),vs={class:"footer-box"},ms={key:4,class:"position-info"},hs={class:"info-contain"},bs={class:"box_tip"},fs=q((()=>p("br",null,null,-1))),xs={class:"box_tip_large"},gs={class:"down-times"},js={class:"box_tip"},ks=q((()=>p("img",{src:e,alt:""},null,-1))),ys={class:"footer-box"},_s={key:5,class:"position-info"},$s={class:"info-contain"},Ts={class:"box_tip_large"},ws={class:"box_tip_large"},Ss={class:"box_tip"},Bs={class:"footer-box"},Is=I(t({__name:"arrive",setup(e){x();const t=g();j();let h=o("1");const b=o(""),I=a({passCode:[]}),{boxData:q,isBoorError:Is,selectBoxList:Ls}=C(t),Cs=o(t.hotelSetting.siteTime);let qs=t.hotelSetting.siteTime-90;l((()=>{T.on("callPhoneCode",(s=>{console.log("callPhoneCode=>"+JSON.stringify(s)),s.forEach((s=>{b.value=b.value?b.value+`,${s.code}`:s.code})),I.passCode=s})),T.on("doorStatus",(s=>{console.log(JSON.stringify(s)+55555555555),2===s.type?(Ds(t.hotelSetting.takeAwayTime),Ps(),h.value="3"):3===s.type?t.selectBoxList.selectData.length?(h.value=(t.hotelSetting.verifyType.id||1)+"",Ds(t.hotelSetting.siteTime),Ps()):(Ds(5),Ps(),h.value="4"):5===s.type&&(Ds(t.hotelSetting.takeAwayTime),Ps(),h.value="3")})),qs=t.hotelSetting.siteTime-90,2===t.hotelTaskType?(h.value="5",y.getInstance().spliceTask(),Ds(5),Ps()):(h.value=(t.hotelSetting.verifyType.id||1)+"",Ds(),Ps())}));let zs="";n((()=>{T.off("doorStatus"),w.getInstance().removeTime("arrive"),y.getInstance().HangupPhone(),zs=""})),i((()=>t.isBoorError),((s,e,t)=>{s&&(h.value=Is.value)}));const Ps=()=>{w.getInstance().startTime("arrive",1e3,Cs.value,(s=>(Cs.value=s,console.log(Cs.value,qs),!S.isShowStatus()&&Cs.value==qs&&Cs.value>10&&(console.log("=============callPhone============"),B.onWriteLog("info","callPhone",{selectBoxList:t.selectBoxList},"callPhoneTime"+Cs.value),y.getInstance().callPhoneBefore(t.selectBoxList,Math.ceil((Cs.value-10)/10)),qs=Cs.value-90),0===s&&("1"===h.value||"2"===h.value?Gs():"3"===h.value?Fs():"4"!==h.value&&"5"!==h.value||Js()),!S.isShowStatus())))};function Ds(s=""){clearTimeout(null),w.getInstance().stopTime("arrive"),qs=t.hotelSetting.siteTime-90,Cs.value=s||t.hotelSetting.siteTime}function Es(){k.showTimes();const s=t.selectBoxList;y.getInstance().openBoxGet(s,"taskList").then((s=>{}))}function Rs(s){zs=s}function As(){if(console.log(b.value,zs,b.value.includes(zs)),!b.value&&t.selectBoxList.selectData.length&&(b.value=t.selectBoxList.selectData.reduce(((s,e)=>(s.push(e.code),s.join(","))),[])),console.log(b.value,zs,b.value.includes(zs)),b.value&&4===zs.length&&b.value.includes(zs)){k.showTimes();const s=t.selectBoxList;y.getInstance().openBoxCodeGet(s,zs,"taskList").then((s=>{}))}}function Fs(){k.showTimes(),y.getInstance().closeBox(1).then((s=>{}))}function Gs(){const s=t.selectBoxList;y.getInstance().changeLeaveTask(s)}const Js=()=>{y.getInstance().checkBoxStatus().then((s=>{k.close(),s&&y.getInstance().nextTask()}))};function Ns(){let s=_.getInstance();j().isTasking&&(k.show(),s.cancelTask().then((s=>{y.getInstance().endTaskBefore(),k.close()})).catch((s=>{k.close()}))),y.getInstance().clearBoxBoorError(),$.push({path:"/hotel/homes"})}return(e,t)=>(f(),c("div",z,[d(s,{isSendFoodSuccess:r(h),type:"2"},null,8,["isSendFoodSuccess"]),"1"===r(h)?(f(),c("div",P,[p("div",D,[p("span",E,[u(v(e.$t("task.ydd"))+v(r(Ls).name),1),R]),p("span",A,v(e.$t("hotel.qzkxhqzhwbgbxm")),1)]),p("div",F,[p("div",G,[p("span",J,v(Cs.value)+"s",1),u(v(e.$t("hotel.qlbshd")),1)]),p("div",{class:"close-btn",onClick:Es},[p("span",null,v(e.$t("hotel.djkx")),1)])])])):m("",!0),"2"===r(h)?(f(),c("div",N,[p("span",O,[u(v(e.$t("task.ydd"))+v(r(Ls).name),1),W]),p("div",X,[d(L,{onSuccess:Rs,type:b.value},null,8,["type"])]),p("div",H,[p("div",K,[p("span",M,v(Cs.value)+"s",1),u(v(e.$t("hotel.hlkbshd")),1)]),p("div",{class:"close-btn",onClick:As},[p("span",null,v(e.$t("hotel.djkx")),1)])])])):m("",!0),"3"===r(h)?(f(),c("div",Z,[p("div",Q,[p("span",U,[u(v(e.$t("task.ydd"))+v(r(Ls).name),1),V]),p("span",Y,v(e.$t("hotel.qqzwp")),1),p("span",ss,v(e.$t("hotel.qjkqhbgbxm")),1)]),p("div",es,[p("div",ts,[p("span",os,v(Cs.value)+"s",1),u(v(e.$t("hotel.hzdgx")),1)]),p("div",{class:"close-btn",onClick:Fs},[p("span",null,v(e.$t("hotel.djgx")),1)])])])):m("",!0),"4"===r(h)?(f(),c("div",as,[p("div",ls,[p("span",ns,[u(v(e.$t("task.ydd"))+v(r(Ls).name),1),is]),p("span",cs,v(e.$t("hotel.shwc")),1),p("span",ds,[u(v(e.$t("hotel.jz")),1),p("span",rs,v(Cs.value)+"s",1),u(v(e.$t("hotel.hlk")),1)]),p("span",ps,[us,u(v(e.$t("hotel.gxndsy")),1)])]),p("div",vs,[p("div",{class:"close-btn",onClick:Js},[p("span",null,v(e.$t("hotel.ljlk")),1)])])])):m("",!0),"5"===r(h)?(f(),c("div",ms,[p("div",hs,[p("span",bs,[u(v(e.$t("task.ydd"))+v(r(Ls).name),1),fs]),p("span",xs,[u(v(e.$t("hotel.jz")),1),p("span",gs,v(Cs.value)+"s",1),u(v(e.$t("hotel.hlk")),1)]),p("span",js,[ks,u(v(e.$t("hotel.gxndsy")),1)])]),p("div",ys,[p("div",{class:"close-btn",onClick:Js},[p("span",null,v(e.$t("hotel.ljlk")),1)])])])):m("",!0),"error"===r(h)?(f(),c("div",_s,[p("div",$s,[p("span",Ts,v(e.$t("hotel.hbq")),1),p("span",ws,v(e.$t("hotel.xmcxyc")),1),p("span",Ss,v(e.$t("hotel.rwwfjxzxqlxgly")),1)]),p("div",Bs,[p("div",{class:"close-btn",onClick:Ns},[p("span",null,v(e.$t("hotel.fhsy")),1)])])])):m("",!0)]))}}),[["__scopeId","data-v-49588db2"]]);export{Is as default};
